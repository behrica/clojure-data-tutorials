[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Noj tutorials",
    "section": "",
    "text": "This is part of the Scicloj Clojure Data Scrapbook.\n\n1 Preface\nNoj (short for Scinojure) is an opinionated way to use the emerging Clojure data stack. It collects a few of the relevant libraries together and addes some layers of composition on top of them.\n\nsource: projects/noj/notebooks/index.clj",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "ml.html",
    "href": "ml.html",
    "title": "2  Machine learning - DRAFT",
    "section": "",
    "text": "2.1 Linear regression\nWe will explore the Iris dataset:\n_unnamed [5 5]:\nA Metamorph pipeline for linear regression:\nTraining and evaluating the pipeline on various subsets:\nPrinting one of the trained models (note that the Smile regression model is recognized by Kindly and printed correctly):",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Machine learning - DRAFT</span>"
    ]
  },
  {
    "objectID": "ml.html#linear-regression",
    "href": "ml.html#linear-regression",
    "title": "2  Machine learning - DRAFT",
    "section": "",
    "text": "(tc/head datasets/iris)\n\n\n\n\n\n\n\n\n\n\n\n\n:sepal-length\n:sepal-width\n:petal-length\n:petal-width\n:species\n\n\n\n\n5.1\n3.5\n1.4\n0.2\nsetosa\n\n\n4.9\n3.0\n1.4\n0.2\nsetosa\n\n\n4.7\n3.2\n1.3\n0.2\nsetosa\n\n\n4.6\n3.1\n1.5\n0.2\nsetosa\n\n\n5.0\n3.6\n1.4\n0.2\nsetosa\n\n\n\n\n\n(def additive-pipeline\n  (ml/pipeline\n   (mm/set-inference-target :sepal-length)\n   (mm/drop-columns [:species])\n   {:metamorph/id :model}\n   (mm/model {:model-type :smile.regression/ordinary-least-square})))\n\n\n\n(def evaluations\n  (ml/evaluate-pipelines\n   [additive-pipeline]\n   (ds/split-&gt;seq datasets/iris :holdout)\n   ml/rmse\n   :loss\n   {:other-metrices [{:name :r2\n                      :metric-fn fastmath.stats/r2-determination}]}))\n\n\n\n(-&gt; evaluations\n    flatten\n    first\n    :fit-ctx\n    :model\n    ml/thaw-model)\n\n\nLinear Model:\n\nResiduals:\n       Min          1Q      Median          3Q         Max\n   -0.8076     -0.2157      0.0177      0.2335      0.7341\n\nCoefficients:\n                  Estimate Std. Error    t value   Pr(&gt;|t|)\nIntercept           1.8682     0.2970     6.2904     0.0000 ***\nsepal-width         0.6388     0.0786     8.1279     0.0000 ***\npetal-length        0.7250     0.0713    10.1635     0.0000 ***\npetal-width        -0.5999     0.1646    -3.6449     0.0004 ***\n---------------------------------------------------------------------\nSignificance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3197 on 96 degrees of freedom\nMultiple R-squared: 0.8499,    Adjusted R-squared: 0.8452\nF-statistic: 181.1746 on 4 and 96 DF,  p-value: 2.137e-39\n\n\nsource: projects/noj/notebooks/ml.clj",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Machine learning - DRAFT</span>"
    ]
  },
  {
    "objectID": "ggplot.html",
    "href": "ggplot.html",
    "title": "3  Exploring ggplot - DRAFT",
    "section": "",
    "text": "3.1 Setup\nWe will use ClojisR to call R from Clojure.\nLoading ggplot2:\nThe base R library:",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Exploring ggplot - DRAFT</span>"
    ]
  },
  {
    "objectID": "ggplot.html#setup",
    "href": "ggplot.html#setup",
    "title": "3  Exploring ggplot - DRAFT",
    "section": "",
    "text": "(ns ggplot\n  (:require [clojisr.v1.r :as r :refer [r r$ r-&gt;clj]]\n            [clojisr.v1.applications.plotting :as plotting]\n            [scicloj.kindly.v4.kind :as kind]\n            [clojure.walk :as walk]\n            [tablecloth.api :as tc]\n            [editscript.core :as editscript]\n            [clojure.pprint :as pp]\n            [clojure.string :as str]))\n\n\n\n(r/library \"ggplot2\")\n\n\n[1] \"ggplot2\"   \"Rserve\"    \"stats\"     \"graphics\"  \"grDevices\" \"utils\"    \n[7] \"datasets\"  \"methods\"   \"base\"     \n\n\n\n\n(r/require-r '[base])\n\n\nnil",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Exploring ggplot - DRAFT</span>"
    ]
  },
  {
    "objectID": "ggplot.html#an-example-plot",
    "href": "ggplot.html#an-example-plot",
    "title": "3  Exploring ggplot - DRAFT",
    "section": "3.2 An example plot",
    "text": "3.2 An example plot\nHere is how we may generate and display a plot:\n\n(-&gt; \"(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point()\n         + stat_smooth(method=\\\"lm\\\")\n         + facet_wrap(~cyl))\"\n    r\n    plotting/plot-&gt;svg\n    kind/html)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n\n\n\n\n\n  \n\n\n\n\n\n  \n\n\n\n\n\n  \n\n\n\n\n\n\n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n\n\n\n\n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n\n\n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n  \n  \n\n\n\n\n\n\n  \n  \n  \n\n\n  \n  \n  \n\n\n\n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n\n\n  \n\n\n  \n\n\n  \n\n\n\n\nWe may also generate the R code from a Clojure form and pass Clojure data to R, but for now, we are simply using R code using an R dataset. We are using the mpg dataset, which is part of the ggplot package.\n\n(-&gt; \"mpg\"\n    r\n    r-&gt;clj)\n\n_unnamed [234 11]:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n:manufacturer\n:model\n:displ\n:year\n:cyl\n:trans\n:drv\n:cty\n:hwy\n:fl\n:class\n\n\n\n\naudi\na4\n1.8\n1999\n4\nauto(l5)\nf\n18\n29\np\ncompact\n\n\naudi\na4\n1.8\n1999\n4\nmanual(m5)\nf\n21\n29\np\ncompact\n\n\naudi\na4\n2.0\n2008\n4\nmanual(m6)\nf\n20\n31\np\ncompact\n\n\naudi\na4\n2.0\n2008\n4\nauto(av)\nf\n21\n30\np\ncompact\n\n\naudi\na4\n2.8\n1999\n6\nauto(l5)\nf\n16\n26\np\ncompact\n\n\naudi\na4\n2.8\n1999\n6\nmanual(m5)\nf\n18\n26\np\ncompact\n\n\naudi\na4\n3.1\n2008\n6\nauto(av)\nf\n18\n27\np\ncompact\n\n\naudi\na4 quattro\n1.8\n1999\n4\nmanual(m5)\n4\n18\n26\np\ncompact\n\n\naudi\na4 quattro\n1.8\n1999\n4\nauto(l5)\n4\n16\n25\np\ncompact\n\n\naudi\na4 quattro\n2.0\n2008\n4\nmanual(m6)\n4\n20\n28\np\ncompact\n\n\n…\n…\n…\n…\n…\n…\n…\n…\n…\n…\n…\n\n\nvolkswagen\nnew beetle\n2.0\n1999\n4\nmanual(m5)\nf\n21\n29\nr\nsubcompact\n\n\nvolkswagen\nnew beetle\n2.0\n1999\n4\nauto(l4)\nf\n19\n26\nr\nsubcompact\n\n\nvolkswagen\nnew beetle\n2.5\n2008\n5\nmanual(m5)\nf\n20\n28\nr\nsubcompact\n\n\nvolkswagen\nnew beetle\n2.5\n2008\n5\nauto(s6)\nf\n20\n29\nr\nsubcompact\n\n\nvolkswagen\npassat\n1.8\n1999\n4\nmanual(m5)\nf\n21\n29\np\nmidsize\n\n\nvolkswagen\npassat\n1.8\n1999\n4\nauto(l5)\nf\n18\n29\np\nmidsize\n\n\nvolkswagen\npassat\n2.0\n2008\n4\nauto(s6)\nf\n19\n28\np\nmidsize\n\n\nvolkswagen\npassat\n2.0\n2008\n4\nmanual(m6)\nf\n21\n29\np\nmidsize\n\n\nvolkswagen\npassat\n2.8\n1999\n6\nauto(l5)\nf\n16\n26\np\nmidsize\n\n\nvolkswagen\npassat\n2.8\n1999\n6\nmanual(m5)\nf\n18\n26\np\nmidsize\n\n\nvolkswagen\npassat\n3.6\n2008\n6\nauto(s6)\nf\n17\n26\np\nmidsize",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Exploring ggplot - DRAFT</span>"
    ]
  },
  {
    "objectID": "ggplot.html#representing-plots-as-clojure-data",
    "href": "ggplot.html#representing-plots-as-clojure-data",
    "title": "3  Exploring ggplot - DRAFT",
    "section": "3.3 Representing plots as Clojure data",
    "text": "3.3 Representing plots as Clojure data\nA ggplot object is an R list of ggproto objects. We recursively unwrap this structure and convert it to Clojure.\n\n(defn ggplot-&gt;clj\n  ([r-obj\n    options]\n   (ggplot-&gt;clj r-obj options []))\n  ([r-obj\n    {:as options\n     :keys [avoid]}\n    path]\n   #_(prn path)\n   (let [relevant-names (some-&gt;&gt; r-obj\n                                 r.base/names\n                                 r-&gt;clj\n                                 (filter (complement avoid)))]\n     (cond\n       ;;\n       ;; a named list or a ggproto object\n       (seq relevant-names) (-&gt;&gt; relevant-names\n                                 (map (fn [nam]\n                                        [(keyword nam) (-&gt; r-obj\n                                                           (r$ nam)\n                                                           (ggplot-&gt;clj options\n                                                                        (conj path nam)))]))\n                                 (into {}))\n       ;;\n       ;; a ggproto method\n       (-&gt; r-obj\n           r.base/class\n           r-&gt;clj\n           first\n           (= \"ggproto_method\"))\n       :ggproto-method\n       ;;\n       ;; an unnamed list\n       (-&gt; r-obj\n           r.base/is-list\n           r-&gt;clj\n           first)\n       (-&gt; r-obj\n           r.base/length\n           r-&gt;clj\n           first\n           range\n           (-&gt;&gt; (mapv (fn [i]\n                        (-&gt; r-obj\n                            (r/brabra (inc i))\n                            (ggplot-&gt;clj options\n                                         (conj path [i])))))))\n       ;;\n       (r.base/is-atomic r-obj) (try (r-&gt;clj r-obj)\n                                     (catch Exception e\n                                       (-&gt; r-obj println with-out-str)))\n       :else r-obj))))\n\nIn the conversion, we avoid some big parts of the structure, e.g., the \"plot_env\" member. We also do no report the toplevel \"data\" member, which is simply the dataset. For example:\n\n(-&gt; \"(ggplot(mpg, aes(cty, hwy))\n         + geom_point())\"\n    r\n    (ggplot-&gt;clj {:avoid #{\"plot_env\"}})\n    (dissoc :data))\n\n\n{:layers\n [{:aes_params [],\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor [geom_point],\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales {:scales [], :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"]}}",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Exploring ggplot - DRAFT</span>"
    ]
  },
  {
    "objectID": "ggplot.html#exlploring-a-few-plots",
    "href": "ggplot.html#exlploring-a-few-plots",
    "title": "3  Exploring ggplot - DRAFT",
    "section": "3.4 Exlploring a few plots",
    "text": "3.4 Exlploring a few plots\nLet us explore and compare a few plots this way:\n\n(defn h3 [title] (kind/hiccup [:h3 title]))\n\n\n(defn h4 [title] (kind/hiccup [:h4 title]))\n\n\n(defn ggplot-summary\n  ([title r-code]\n   (ggplot-summary r-code))\n  ([title r-code prev-clj-to-compare]\n   (let [plot (r r-code)\n         clj (-&gt; plot\n                 (ggplot-&gt;clj {:avoid #{\"plot_env\"}})\n                 (dissoc :data))]\n     {:title title\n      :r-code r-code\n      :image (plotting/plot-&gt;buffered-image plot)\n      :clj clj\n      :diff (when prev-clj-to-compare\n              (-&gt; prev-clj-to-compare\n                  (editscript/diff clj)\n                  pp/pprint\n                  with-out-str\n                  (str/replace #\": \" \":_ \")\n                  read-string))})))\n\n\n(defn view-summary [{:keys [title r-code image clj diff]}]\n  (kind/fragment\n   [(h3 title)\n    (h4 \"R code\")\n    (kind/md\n     (format \"\\n```\\n%s\\n```\\n\"\n             r-code))\n    (h4 \"plot\")\n    image\n    (h4 \"clj data\")\n    clj\n    (when diff\n      (kind/fragment\n       [(h4 \"clj diff with previous\")\n        diff]))]))\n\n\n(-&gt;&gt; [;;\n      [\"A scatterplot\"\n       \"(ggplot(mpg, aes(cty, hwy))\n         + geom_point())\"]\n      ;;\n      [\"A scatterplot with colours\"\n       \"(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point())\"]\n      ;;\n      [\"A scatterplot with colours and smoothing\"\n       \"(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point()\n         + stat_smooth(method=\\\"lm\\\"))\"]\n      ;;\n      [\"A scatterplot with colours, smoothing, and facets\"\n       \"(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point()\n         + stat_smooth(method=\\\"lm\\\")\n         + facet_wrap(~cyl))\"]]\n     (reductions (fn [prev-summary [title r-code]]\n                   (ggplot-summary title\n                                   r-code\n                                   (:clj prev-summary)))\n                 nil)\n     rest\n     (map view-summary)\n     kind/fragment)\n\nA scatterplot\nR code\n(ggplot(mpg, aes(cty, hwy))\n         + geom_point())\nplot\n\nclj data\n\n{:layers\n [{:aes_params [],\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor [geom_point],\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales {:scales [], :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"]}}\n\nA scatterplot with colours\nR code\n(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point())\nplot\n\nclj data\n\n{:layers\n [{:aes_params [],\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor [geom_point],\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales {:scales [], :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy], :colour [~ [factor cyl]]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"], :colour [\"factor(cyl)\"]}}\n\nclj diff with previous\n\n[[[:mapping :colour] :+ [~[factor cyl]]]\n [[:labels :colour] :+ [\"factor(cyl)\"]]]\n\nA scatterplot with colours and smoothing\nR code\n(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point()\n         + stat_smooth(method=\"lm\"))\nplot\n\nclj data\n\n{:layers\n [{:aes_params [],\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor [geom_point],\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}\n  {:aes_params [],\n   :stat\n   {:extra_params [\"na.rm\" \"orientation\"],\n    :super :ggproto-method,\n    :compute_group :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :setup_params :ggproto-method,\n    :dropped_aes [\"weight\"]},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:se [true], :na.rm [false], :orientation [nil]},\n   :geom\n   {:setup_params :ggproto-method,\n    :super :ggproto-method,\n    :draw_key :ggproto-method,\n    :extra_params [\"na.rm\" \"orientation\"],\n    :required_aes [\"x\" \"y\"],\n    :draw_group :ggproto-method,\n    :optional_aes [\"ymin\" \"ymax\"],\n    :rename_size [true],\n    :setup_data :ggproto-method,\n    :default_aes\n    {:colour [\"#3366FF\"],\n     :fill [\"grey60\"],\n     :linewidth [1.0],\n     :linetype [1.0],\n     :weight [1.0],\n     :alpha [0.4]}},\n   :stat_params\n   {:na.rm [false],\n    :method [\"lm\"],\n    :n [80.0],\n    :orientation [nil],\n    :level [0.95],\n    :fullrange [false],\n    :se [true],\n    :formula nil,\n    :method.args [],\n    :span [0.75]},\n   :constructor {: nil, :method [\"lm\"]},\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales {:scales [], :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy], :colour [~ [factor cyl]]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"], :colour [\"factor(cyl)\"]}}\n\nclj diff with previous\n\n[[[:layers 1]\n  :+\n  {:aes_params [],\n   :stat\n   {:extra_params [\"na.rm\" \"orientation\"],\n    :super :ggproto-method,\n    :compute_group :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :setup_params :ggproto-method,\n    :dropped_aes [\"weight\"]},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:se [true], :na.rm [false], :orientation [nil]},\n   :geom\n   {:setup_params :ggproto-method,\n    :super :ggproto-method,\n    :draw_key :ggproto-method,\n    :extra_params [\"na.rm\" \"orientation\"],\n    :required_aes [\"x\" \"y\"],\n    :draw_group :ggproto-method,\n    :optional_aes [\"ymin\" \"ymax\"],\n    :rename_size [true],\n    :setup_data :ggproto-method,\n    :default_aes\n    {:colour [\"#3366FF\"],\n     :fill [\"grey60\"],\n     :linewidth [1.0],\n     :linetype [1.0],\n     :weight [1.0],\n     :alpha [0.4]}},\n   :stat_params\n   {:na.rm [false],\n    :method [\"lm\"],\n    :n [80.0],\n    :orientation [nil],\n    :level [0.95],\n    :fullrange [false],\n    :se [true],\n    :formula nil,\n    :method.args [],\n    :span [0.75]},\n   :constructor {:_ nil, :method [\"lm\"]},\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}]]\n\nA scatterplot with colours, smoothing, and facets\nR code\n(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point()\n         + stat_smooth(method=\"lm\")\n         + facet_wrap(~cyl))\nplot\n\nclj data\n\n{:layers\n [{:aes_params [],\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor [geom_point],\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}\n  {:aes_params [],\n   :stat\n   {:extra_params [\"na.rm\" \"orientation\"],\n    :super :ggproto-method,\n    :compute_group :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :setup_params :ggproto-method,\n    :dropped_aes [\"weight\"]},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:se [true], :na.rm [false], :orientation [nil]},\n   :geom\n   {:setup_params :ggproto-method,\n    :super :ggproto-method,\n    :draw_key :ggproto-method,\n    :extra_params [\"na.rm\" \"orientation\"],\n    :required_aes [\"x\" \"y\"],\n    :draw_group :ggproto-method,\n    :optional_aes [\"ymin\" \"ymax\"],\n    :rename_size [true],\n    :setup_data :ggproto-method,\n    :default_aes\n    {:colour [\"#3366FF\"],\n     :fill [\"grey60\"],\n     :linewidth [1.0],\n     :linetype [1.0],\n     :weight [1.0],\n     :alpha [0.4]}},\n   :stat_params\n   {:na.rm [false],\n    :method [\"lm\"],\n    :n [80.0],\n    :orientation [nil],\n    :level [0.95],\n    :fullrange [false],\n    :se [true],\n    :formula nil,\n    :method.args [],\n    :span [0.75]},\n   :constructor {: nil, :method [\"lm\"]},\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales {:scales [], :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy], :colour [~ [factor cyl]]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet\n {:params\n  {:dir [\"h\"],\n   :nrow nil,\n   :as.table [true],\n   :free {:x [false], :y [false]},\n   :drop [true],\n   :strip.position [\"top\"],\n   :ncol nil,\n   :facets {:cyl [~ cyl]},\n   :labeller\n   \"function (labels, multi_line = TRUE) \\n{\\n    labels &lt;- lapply(labels, as.character)\\n    if (multi_line) {\\n        labels\\n    }\\n    else {\\n        collapse_labels_lines(labels)\\n    }\\n}\\n&lt;bytecode: 0x557f413a3978&gt;\\n&lt;environment: namespace:ggplot2&gt;\\nattr(,\\\"class\\\")\\n[1] \\\"function\\\" \\\"labeller\\\"\\n\"},\n  :shrink [true],\n  :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"], :colour [\"factor(cyl)\"]}}\n\nclj diff with previous\n\n[[[:facet :params]\n  :+\n  {:dir [\"h\"],\n   :nrow nil,\n   :as.table [true],\n   :free {:x [false], :y [false]},\n   :drop [true],\n   :strip.position [\"top\"],\n   :ncol nil,\n   :facets {:cyl [~cyl]},\n   :labeller\n   \"function (labels, multi_line = TRUE) \\n{\\n    labels &lt;- lapply(labels, as.character)\\n    if (multi_line) {\\n        labels\\n    }\\n    else {\\n        collapse_labels_lines(labels)\\n    }\\n}\\n&lt;bytecode:_ 0x557f413a3978&gt;\\n&lt;environment:_ namespace:ggplot2&gt;\\nattr(,\\\"class\\\")\\n[1] \\\"function\\\" \\\"labeller\\\"\\n\"}]]\n\n\nsource: projects/noj/notebooks/ggplot.clj",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Exploring ggplot - DRAFT</span>"
    ]
  }
]