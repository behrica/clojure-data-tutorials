[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Exploring ggplot",
    "section": "",
    "text": "This is part of the Scicloj Clojure Data Scrapbook.\n\n1 Preface\nIn this series of notebooks, we explore ggplot2, a famous R package for grammar-of-graphics data visualization, from within Clojure.\n\nsource: projects/datavis/ggplot/notebooks/index.clj",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "using_clojisr.html",
    "href": "using_clojisr.html",
    "title": "2  Using ggplot in Clojure with ClojisR",
    "section": "",
    "text": "2.1 Setup\nWe will use ClojisR to call R from Clojure.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Using ggplot in Clojure with ClojisR</span>"
    ]
  },
  {
    "objectID": "using_clojisr.html#setup",
    "href": "using_clojisr.html#setup",
    "title": "2  Using ggplot in Clojure with ClojisR",
    "section": "",
    "text": "(ns using-clojisr\n  (:require [clojisr.v1.r :as r :refer [r]]\n            [clojisr.v1.applications.plotting :as plotting]\n            [scicloj.kindly.v4.kind :as kind]\n            [tablecloth.api :as tc]))",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Using ggplot in Clojure with ClojisR</span>"
    ]
  },
  {
    "objectID": "using_clojisr.html#plotting-by-calling-r-code",
    "href": "using_clojisr.html#plotting-by-calling-r-code",
    "title": "2  Using ggplot in Clojure with ClojisR",
    "section": "2.2 Plotting by calling R code",
    "text": "2.2 Plotting by calling R code\nLet us load ggplot2 at the R runtime:\n\n(r/library \"ggplot2\")\n\n\n[1] \"ggplot2\"   \"Rserve\"    \"stats\"     \"graphics\"  \"grDevices\" \"utils\"    \n[7] \"datasets\"  \"methods\"   \"base\"     \n\n\nWe will use the mpg dataset, which is part of the ggplot package.\n\n(-&gt; \"mpg\"\n    r\n    r/r-&gt;clj)\n\n\n_unnamed [234 11]:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n:manufacturer\n:model\n:displ\n:year\n:cyl\n:trans\n:drv\n:cty\n:hwy\n:fl\n:class\n\n\n\n\naudi\na4\n1.8\n1999\n4\nauto(l5)\nf\n18\n29\np\ncompact\n\n\naudi\na4\n1.8\n1999\n4\nmanual(m5)\nf\n21\n29\np\ncompact\n\n\naudi\na4\n2.0\n2008\n4\nmanual(m6)\nf\n20\n31\np\ncompact\n\n\naudi\na4\n2.0\n2008\n4\nauto(av)\nf\n21\n30\np\ncompact\n\n\naudi\na4\n2.8\n1999\n6\nauto(l5)\nf\n16\n26\np\ncompact\n\n\naudi\na4\n2.8\n1999\n6\nmanual(m5)\nf\n18\n26\np\ncompact\n\n\naudi\na4\n3.1\n2008\n6\nauto(av)\nf\n18\n27\np\ncompact\n\n\naudi\na4 quattro\n1.8\n1999\n4\nmanual(m5)\n4\n18\n26\np\ncompact\n\n\naudi\na4 quattro\n1.8\n1999\n4\nauto(l5)\n4\n16\n25\np\ncompact\n\n\naudi\na4 quattro\n2.0\n2008\n4\nmanual(m6)\n4\n20\n28\np\ncompact\n\n\n…\n…\n…\n…\n…\n…\n…\n…\n…\n…\n…\n\n\nvolkswagen\nnew beetle\n2.0\n1999\n4\nmanual(m5)\nf\n21\n29\nr\nsubcompact\n\n\nvolkswagen\nnew beetle\n2.0\n1999\n4\nauto(l4)\nf\n19\n26\nr\nsubcompact\n\n\nvolkswagen\nnew beetle\n2.5\n2008\n5\nmanual(m5)\nf\n20\n28\nr\nsubcompact\n\n\nvolkswagen\nnew beetle\n2.5\n2008\n5\nauto(s6)\nf\n20\n29\nr\nsubcompact\n\n\nvolkswagen\npassat\n1.8\n1999\n4\nmanual(m5)\nf\n21\n29\np\nmidsize\n\n\nvolkswagen\npassat\n1.8\n1999\n4\nauto(l5)\nf\n18\n29\np\nmidsize\n\n\nvolkswagen\npassat\n2.0\n2008\n4\nauto(s6)\nf\n19\n28\np\nmidsize\n\n\nvolkswagen\npassat\n2.0\n2008\n4\nmanual(m6)\nf\n21\n29\np\nmidsize\n\n\nvolkswagen\npassat\n2.8\n1999\n6\nauto(l5)\nf\n16\n26\np\nmidsize\n\n\nvolkswagen\npassat\n2.8\n1999\n6\nmanual(m5)\nf\n18\n26\np\nmidsize\n\n\nvolkswagen\npassat\n3.6\n2008\n6\nauto(s6)\nf\n17\n26\np\nmidsize\n\n\n\n\nHere is how we may generate a plot from R code:\n\n(def plot1\n  (r \"(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point()\n         + stat_smooth(method=\\\"lm\\\")\n         + facet_wrap(~cyl))\"))\n\nRendering as SVG:\n\n(-&gt; plot1\n    plotting/plot-&gt;svg\n    kind/html)\n\n\n\n\n  \n\n\n\n  \n    \n  \n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n6\n\n\n\n\n  \n    \n  \n\n\n\n8\n\n\n\n\n  \n    \n  \n\n\n\n4\n\n\n\n\n  \n    \n  \n\n\n\n5\n\n\n\n\n\n\n\n\n10\n15\n20\n25\n30\n35\n\n\n\n\n\n\n10\n15\n20\n25\n30\n35\n10\n20\n30\n40\n\n\n\n\n10\n20\n30\n40\n\n\n\n\ncty\nhwy\n\nfactor(cyl)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n4\n5\n6\n8\n\n\n\nRendering as a bitmap image:\n\n(-&gt; plot1\n    plotting/plot-&gt;buffered-image)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Using ggplot in Clojure with ClojisR</span>"
    ]
  },
  {
    "objectID": "using_clojisr.html#plotting-by-calling-generated-r-code",
    "href": "using_clojisr.html#plotting-by-calling-generated-r-code",
    "title": "2  Using ggplot in Clojure with ClojisR",
    "section": "2.3 Plotting by calling generated R code",
    "text": "2.3 Plotting by calling generated R code\nWe may also plot by generating the R code from a Clojure form.\nLet us require ggplot as a Clojure namespace.\n\n(r/require-r '[ggplot2 :as gg])\n\n\nnil\n\nNow we can plot using code generation:\n\n(-&gt; (r/r+ (gg/ggplot gg/mpg\n                     (gg/aes :x 'cty\n                             :y 'hwy\n                             :color '(factor cyl)))\n          (gg/geom_point)\n          (gg/stat_smooth :method \"lm\")\n          (gg/facet_wrap '(tilde . cyl)))\n    r\n    plotting/plot-&gt;svg\n    kind/html)\n\n\n\n\n  \n\n\n\n  \n    \n  \n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n6\n\n\n\n\n  \n    \n  \n\n\n\n8\n\n\n\n\n  \n    \n  \n\n\n\n4\n\n\n\n\n  \n    \n  \n\n\n\n5\n\n\n\n\n\n\n\n\n10\n15\n20\n25\n30\n35\n\n\n\n\n\n\n10\n15\n20\n25\n30\n35\n10\n20\n30\n40\n\n\n\n\n10\n20\n30\n40\n\n\n\n\ncty\nhwy\n\nfactor(cyl)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n4\n5\n6\n8",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Using ggplot in Clojure with ClojisR</span>"
    ]
  },
  {
    "objectID": "using_clojisr.html#plotting-by-calling-generated-r-code-with-clojure-data",
    "href": "using_clojisr.html#plotting-by-calling-generated-r-code-with-clojure-data",
    "title": "2  Using ggplot in Clojure with ClojisR",
    "section": "2.4 Plotting by calling generated R code with Clojure data",
    "text": "2.4 Plotting by calling generated R code with Clojure data\nWe may further use ClojisR’s code generation with Clojure data.\nLet us read the same mpg dataset. At the scicloj.metamorph.ml.toydata.ggplot namespace of metamorph.ml, we have Clojure copies of ggplot’s toy dataset, represented as tech.ml.dataset datasets.\n\n(require '[scicloj.metamorph.ml.toydata.ggplot\n           :as toydata.ggplot])\n\nNow we can do the same, but pasing a Clojure dataset:\n\n(-&gt; (r/r+ (gg/ggplot toydata.ggplot/mpg\n                     (gg/aes :x 'cty\n                             :y 'hwy\n                             :color '(factor cyl)))\n          (gg/geom_point)\n          (gg/stat_smooth :method \"lm\")\n          (gg/facet_wrap '(tilde . cyl)))\n    r\n    plotting/plot-&gt;svg\n    kind/html)\n\n\n\n\n  \n\n\n\n  \n    \n  \n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n6\n\n\n\n\n  \n    \n  \n\n\n\n8\n\n\n\n\n  \n    \n  \n\n\n\n4\n\n\n\n\n  \n    \n  \n\n\n\n5\n\n\n\n\n\n\n\n\n10\n15\n20\n25\n30\n35\n\n\n\n\n\n\n10\n15\n20\n25\n30\n35\n10\n20\n30\n40\n\n\n\n\n10\n20\n30\n40\n\n\n\n\ncty\nhwy\n\nfactor(cyl)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n4\n5\n6\n8\n\n\n\nAnother example:\n\n(require '[scicloj.metamorph.ml.toydata :as toydata])\n\n\n(-&gt; (r/r+ (gg/ggplot (toydata/iris-ds)\n                     (gg/aes :x 'sepal_length\n                             :y 'petal_length\n                             :xend 'sepal_width\n                             :yend 'petal_width\n                             :color '(factor species)))\n          (gg/geom_segment :size 5\n                           :alpha 0.1)\n          (gg/scale_color_brewer :palette \"Set1\"))\n    r\n    plotting/plot-&gt;buffered-image)\n\n\n\n\nReorganizing the code:\n\n(-&gt; (toydata/iris-ds)\n    (gg/ggplot (gg/aes :x 'sepal_length\n                       :y 'petal_length\n                       :xend 'sepal_width\n                       :yend 'petal_width\n                       :color '(factor species)))\n    (r/r+ (gg/geom_segment :size 5\n                           :alpha 0.1)\n          (gg/scale_color_brewer :palette \"Set1\"))\n    r\n    plotting/plot-&gt;buffered-image)\n\n\n\n\n\nsource: projects/datavis/ggplot/notebooks/using_clojisr.clj",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Using ggplot in Clojure with ClojisR</span>"
    ]
  },
  {
    "objectID": "representing.html",
    "href": "representing.html",
    "title": "3  Representing ggplot plots as Clojure data",
    "section": "",
    "text": "3.1 A representation function\nA ggplot object is an R list of ggproto objects. We recursively unwrap this structure and convert it to Clojure.\nIn the conversion, we avoid some big parts of the structure, e.g., the \"plot_env\" member. We also do no report the toplevel \"data\" member, which is simply the dataset.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Representing ggplot plots as Clojure data</span>"
    ]
  },
  {
    "objectID": "representing.html#a-representation-function",
    "href": "representing.html#a-representation-function",
    "title": "3  Representing ggplot plots as Clojure data",
    "section": "",
    "text": "(defn ggplot-&gt;clj\n  ([r-obj]\n   (ggplot-&gt;clj r-obj {} []))\n  ([r-obj\n    {:as options\n     :keys [avoid]\n     :or {avoid #{\"plot_env\"}}}\n    path]\n   #_(prn path)\n   (let [relevant-names (some-&gt;&gt; r-obj\n                                 r.base/names\n                                 r-&gt;clj\n                                 (filter (complement avoid)))]\n     (cond\n       ;;\n       ;; a named list or a ggproto object\n       (seq relevant-names) (-&gt;&gt; relevant-names\n                                 (map (fn [nam]\n                                        [(keyword nam) (-&gt; r-obj\n                                                           (r$ nam)\n                                                           (ggplot-&gt;clj options\n                                                                        (conj path nam)))]))\n                                 (into {}))\n       ;;\n       ;; a ggproto method\n       (-&gt; r-obj\n           r.base/class\n           r-&gt;clj\n           first\n           (= \"ggproto_method\"))\n       :ggproto-method\n       ;;\n       ;; an unnamed list\n       (-&gt; r-obj\n           r.base/is-list\n           r-&gt;clj\n           first)\n       (-&gt; r-obj\n           r.base/length\n           r-&gt;clj\n           first\n           range\n           (-&gt;&gt; (mapv (fn [i]\n                        (-&gt; r-obj\n                            (r/brabra (inc i))\n                            (ggplot-&gt;clj options\n                                         (conj path [i])))))))\n       ;;\n       (r.base/is-atomic r-obj) (try (r-&gt;clj r-obj)\n                                     (catch Exception e\n                                       (-&gt; r-obj println with-out-str)))\n       :else r-obj))))",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Representing ggplot plots as Clojure data</span>"
    ]
  },
  {
    "objectID": "representing.html#an-example",
    "href": "representing.html#an-example",
    "title": "3  Representing ggplot plots as Clojure data",
    "section": "3.2 An example",
    "text": "3.2 An example\nFor example:\n\n(delay\n  (-&gt; \"(ggplot(mpg, aes(cty, hwy))\n         + geom_point())\"\n      r\n      ggplot-&gt;clj\n      (dissoc :data)))\n\n\n{:layers\n [{:aes_params [],\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor [geom_point],\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales {:scales [], :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"]}}\n\n\nsource: projects/datavis/ggplot/notebooks/representing.clj",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Representing ggplot plots as Clojure data</span>"
    ]
  },
  {
    "objectID": "comparing.html",
    "href": "comparing.html",
    "title": "4  Comparing the data representations of ggplot plots",
    "section": "",
    "text": "4.1 Exlploring a few plots\nLet us explore and compare a few plots through their Clojure representations:",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Comparing the data representations of ggplot plots</span>"
    ]
  },
  {
    "objectID": "comparing.html#exlploring-a-few-plots",
    "href": "comparing.html#exlploring-a-few-plots",
    "title": "4  Comparing the data representations of ggplot plots",
    "section": "",
    "text": "(defn h3 [title] (kind/hiccup [:h3 title]))\n\n\n(defn h4 [title] (kind/hiccup [:h4 title]))\n\n\n(defn ggplot-summary\n  ([title r-code]\n   (ggplot-summary r-code))\n  ([title r-code prev-clj-to-compare]\n   (let [plot (r r-code)\n         clj (-&gt; plot\n                 representing/ggplot-&gt;clj\n                 (dissoc :data))]\n     {:title title\n      :r-code r-code\n      :image (plotting/plot-&gt;buffered-image plot)\n      :clj clj\n      :diff (when prev-clj-to-compare\n              (-&gt; prev-clj-to-compare\n                  (editscript/diff clj)\n                  pp/pprint\n                  with-out-str\n                  (str/replace #\": \" \":_ \")\n                  read-string))})))\n\n\n(defn view-summary [{:keys [title r-code image clj diff]}]\n  (kind/fragment\n   [(h3 title)\n    (h4 \"R code\")\n    (kind/md\n     (format \"\\n```\\n%s\\n```\\n\"\n             r-code))\n    (h4 \"plot\")\n    image\n    (h4 \"clj data\")\n    clj\n    (when diff\n      (kind/fragment\n       [(h4 \"clj diff with previous\")\n        diff]))]))\n\n\n(-&gt;&gt; [;;\n      [\"A scatterplot\"\n       \"(ggplot(mpg, aes(cty, hwy))\n         + geom_point())\"]\n      ;;\n      [\"A scatterplot with colours\"\n       \"(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point())\"]\n      ;;\n      [\"A scatterplot with colours and smoothing\"\n       \"(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point()\n         + stat_smooth(method=\\\"lm\\\"))\"]\n      ;;\n      [\"A scatterplot with colours, smoothing, and facets\"\n       \"(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point()\n         + stat_smooth(method=\\\"lm\\\")\n         + facet_wrap(~cyl))\"]]\n     (reductions (fn [prev-summary [title r-code]]\n                   (ggplot-summary title\n                                   r-code\n                                   (:clj prev-summary)))\n                 nil)\n     rest\n     (map view-summary)\n     kind/fragment)\n\nA scatterplot\nR code\n(ggplot(mpg, aes(cty, hwy))\n         + geom_point())\nplot\n\n\n\nclj data\n\n{:layers\n [{:aes_params [],\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor [geom_point],\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales {:scales [], :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"]}}\n\n\nnil\n\nA scatterplot with colours\nR code\n(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point())\nplot\n\n\n\nclj data\n\n{:layers\n [{:aes_params [],\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor [geom_point],\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales {:scales [], :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy], :colour [~ [factor cyl]]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"], :colour [\"factor(cyl)\"]}}\n\nclj diff with previous\n\n[[[:mapping :colour] :+ [~[factor cyl]]]\n [[:labels :colour] :+ [\"factor(cyl)\"]]]\n\nA scatterplot with colours and smoothing\nR code\n(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point()\n         + stat_smooth(method=\"lm\"))\nplot\n\n\n\nclj data\n\n{:layers\n [{:aes_params [],\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor [geom_point],\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}\n  {:aes_params [],\n   :stat\n   {:extra_params [\"na.rm\" \"orientation\"],\n    :super :ggproto-method,\n    :compute_group :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :setup_params :ggproto-method,\n    :dropped_aes [\"weight\"]},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:se [true], :na.rm [false], :orientation [nil]},\n   :geom\n   {:setup_params :ggproto-method,\n    :super :ggproto-method,\n    :draw_key :ggproto-method,\n    :extra_params [\"na.rm\" \"orientation\"],\n    :required_aes [\"x\" \"y\"],\n    :draw_group :ggproto-method,\n    :optional_aes [\"ymin\" \"ymax\"],\n    :rename_size [true],\n    :setup_data :ggproto-method,\n    :default_aes\n    {:colour [\"#3366FF\"],\n     :fill [\"grey60\"],\n     :linewidth [1.0],\n     :linetype [1.0],\n     :weight [1.0],\n     :alpha [0.4]}},\n   :stat_params\n   {:na.rm [false],\n    :method [\"lm\"],\n    :n [80.0],\n    :orientation [nil],\n    :level [0.95],\n    :fullrange [false],\n    :se [true],\n    :formula nil,\n    :method.args [],\n    :span [0.75]},\n   :constructor {: nil, :method [\"lm\"]},\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales {:scales [], :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy], :colour [~ [factor cyl]]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"], :colour [\"factor(cyl)\"]}}\n\nclj diff with previous\n\n[[[:layers 1]\n  :+\n  {:aes_params [],\n   :stat\n   {:extra_params [\"na.rm\" \"orientation\"],\n    :super :ggproto-method,\n    :compute_group :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :setup_params :ggproto-method,\n    :dropped_aes [\"weight\"]},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:se [true], :na.rm [false], :orientation [nil]},\n   :geom\n   {:setup_params :ggproto-method,\n    :super :ggproto-method,\n    :draw_key :ggproto-method,\n    :extra_params [\"na.rm\" \"orientation\"],\n    :required_aes [\"x\" \"y\"],\n    :draw_group :ggproto-method,\n    :optional_aes [\"ymin\" \"ymax\"],\n    :rename_size [true],\n    :setup_data :ggproto-method,\n    :default_aes\n    {:colour [\"#3366FF\"],\n     :fill [\"grey60\"],\n     :linewidth [1.0],\n     :linetype [1.0],\n     :weight [1.0],\n     :alpha [0.4]}},\n   :stat_params\n   {:na.rm [false],\n    :method [\"lm\"],\n    :n [80.0],\n    :orientation [nil],\n    :level [0.95],\n    :fullrange [false],\n    :se [true],\n    :formula nil,\n    :method.args [],\n    :span [0.75]},\n   :constructor {:_ nil, :method [\"lm\"]},\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}]]\n\nA scatterplot with colours, smoothing, and facets\nR code\n(ggplot(mpg, aes(cty, hwy, color=factor(cyl)))\n         + geom_point()\n         + stat_smooth(method=\"lm\")\n         + facet_wrap(~cyl))\nplot\n\n\n\nclj data\n\n{:layers\n [{:aes_params [],\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor [geom_point],\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}\n  {:aes_params [],\n   :stat\n   {:extra_params [\"na.rm\" \"orientation\"],\n    :super :ggproto-method,\n    :compute_group :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :setup_params :ggproto-method,\n    :dropped_aes [\"weight\"]},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:se [true], :na.rm [false], :orientation [nil]},\n   :geom\n   {:setup_params :ggproto-method,\n    :super :ggproto-method,\n    :draw_key :ggproto-method,\n    :extra_params [\"na.rm\" \"orientation\"],\n    :required_aes [\"x\" \"y\"],\n    :draw_group :ggproto-method,\n    :optional_aes [\"ymin\" \"ymax\"],\n    :rename_size [true],\n    :setup_data :ggproto-method,\n    :default_aes\n    {:colour [\"#3366FF\"],\n     :fill [\"grey60\"],\n     :linewidth [1.0],\n     :linetype [1.0],\n     :weight [1.0],\n     :alpha [0.4]}},\n   :stat_params\n   {:na.rm [false],\n    :method [\"lm\"],\n    :n [80.0],\n    :orientation [nil],\n    :level [0.95],\n    :fullrange [false],\n    :se [true],\n    :formula nil,\n    :method.args [],\n    :span [0.75]},\n   :constructor {: nil, :method [\"lm\"]},\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales {:scales [], :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy], :colour [~ [factor cyl]]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet\n {:params\n  {:dir [\"h\"],\n   :nrow nil,\n   :as.table [true],\n   :free {:x [false], :y [false]},\n   :drop [true],\n   :strip.position [\"top\"],\n   :ncol nil,\n   :facets {:cyl [~ cyl]},\n   :labeller\n   \"function (labels, multi_line = TRUE) \\n{\\n    labels &lt;- lapply(labels, as.character)\\n    if (multi_line) {\\n        labels\\n    }\\n    else {\\n        collapse_labels_lines(labels)\\n    }\\n}\\n&lt;bytecode: 0x5915e4bd89a8&gt;\\n&lt;environment: namespace:ggplot2&gt;\\nattr(,\\\"class\\\")\\n[1] \\\"function\\\" \\\"labeller\\\"\\n\"},\n  :shrink [true],\n  :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"], :colour [\"factor(cyl)\"]}}\n\nclj diff with previous\n\n[[[:facet :params]\n  :+\n  {:dir [\"h\"],\n   :nrow nil,\n   :as.table [true],\n   :free {:x [false], :y [false]},\n   :drop [true],\n   :strip.position [\"top\"],\n   :ncol nil,\n   :facets {:cyl [~cyl]},\n   :labeller\n   \"function (labels, multi_line = TRUE) \\n{\\n    labels &lt;- lapply(labels, as.character)\\n    if (multi_line) {\\n        labels\\n    }\\n    else {\\n        collapse_labels_lines(labels)\\n    }\\n}\\n&lt;bytecode:_ 0x5915e4bd89a8&gt;\\n&lt;environment:_ namespace:ggplot2&gt;\\nattr(,\\\"class\\\")\\n[1] \\\"function\\\" \\\"labeller\\\"\\n\"}]]\n\n\nsource: projects/datavis/ggplot/notebooks/comparing.clj",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Comparing the data representations of ggplot plots</span>"
    ]
  },
  {
    "objectID": "study_session_20240225.html",
    "href": "study_session_20240225.html",
    "title": "5  Code examples from study session 2024-02-25",
    "section": "",
    "text": "This is part of the Scicloj Clojure Data Scrapbook.\n\n(ns study-session-20240225\n  (:require [clojisr.v1.r :as r :refer [r]]\n            [clojisr.v1.applications.plotting :as plotting]\n            [scicloj.kindly.v4.kind :as kind]\n            [tablecloth.api :as tc]\n            [scicloj.metamorph.ml.toydata :as toydata]\n            [scicloj.metamorph.ml.toydata.ggplot :as toydata.ggplot]\n            [representing]))\n\nAdd ggplot2 to the R runtime:\n\n(r/library \"ggplot2\")\n\n\n[1] \"ggplot2\"   \"Rserve\"    \"stats\"     \"graphics\"  \"grDevices\" \"utils\"    \n[7] \"datasets\"  \"methods\"   \"base\"     \n\n\nThe mpg dataset:\n\n(r \"mpg\")\n\n\n# A tibble: 234 × 11\n   manufacturer model      displ  year   cyl trans drv     cty   hwy fl    class\n   &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;\n 1 audi         a4           1.8  1999     4 auto… f        18    29 p     comp…\n 2 audi         a4           1.8  1999     4 manu… f        21    29 p     comp…\n 3 audi         a4           2    2008     4 manu… f        20    31 p     comp…\n 4 audi         a4           2    2008     4 auto… f        21    30 p     comp…\n 5 audi         a4           2.8  1999     6 auto… f        16    26 p     comp…\n 6 audi         a4           2.8  1999     6 manu… f        18    26 p     comp…\n 7 audi         a4           3.1  2008     6 auto… f        18    27 p     comp…\n 8 audi         a4 quattro   1.8  1999     4 manu… 4        18    26 p     comp…\n 9 audi         a4 quattro   1.8  1999     4 auto… 4        16    25 p     comp…\n10 audi         a4 quattro   2    2008     4 manu… 4        20    28 p     comp…\n# ℹ 224 more rows\n\n\nEvaluating R and showing a plot as a bitmap image:\n\n(plotting/plot-&gt;buffered-image\n (r \"\n(ggplot(mpg, aes(x = cty, y = hwy, color = year)) +\ngeom_point())\n\"))\n\n\n\n\nShowing a plot as svg:\n\n(plotting/plot-&gt;svg\n (r \"\n(ggplot(mpg, aes(x = cty, y = hwy, color = year)) +\ngeom_point())\n\"))\n\n\n\"&lt;?xml version='1.0' encoding='UTF-8' ?&gt;\\n&lt;svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='720.00pt' height='576.00pt' viewBox='0 0 720.00 576.00'&gt;\\n&lt;defs&gt;\\n  &lt;style type='text/css'&gt;&lt;![CDATA[\\n    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {\\n      fill: none;\\n      stroke: #000000;\\n      stroke-linecap: round;\\n      stroke-linejoin: round;\\n      stroke-miterlimit: 10.00;\\n    }\\n    .svglite text {\\n      white-space: pre;\\n    }\\n  ]]&gt;&lt;/style&gt;\\n&lt;/defs&gt;\\n&lt;rect width='100%' height='100%' style='stroke: none; fill: #FFFFFF;'/&gt;\\n&lt;defs&gt;\\n  &lt;clipPath id='cpMC4wMHw3MjAuMDB8MC4wMHw1NzYuMDA='&gt;\\n    &lt;rect x='0.00' y='0.00' width='720.00' height='576.00' /&gt;\\n  &lt;/clipPath&gt;\\n&lt;/defs&gt;\\n&lt;g clip-path='url(#cpMC4wMHw3MjAuMDB8MC4wMHw1NzYuMDA=)'&gt;\\n&lt;rect x='0.00' y='0.00' width='720.00' height='576.00' style='stroke-width: 1.07; stroke: #FFFFFF; fill: #FFFFFF;' /&gt;\\n&lt;/g&gt;\\n&lt;defs&gt;\\n  &lt;clipPath id='cpMzQuNjV8NjQ3LjQ3fDUuNDh8NTQ0LjI5'&gt;\\n    &lt;rect x='34.65' y='5.48' width='612.82' height='538.82' /&gt;\\n  &lt;/clipPath&gt;\\n&lt;/defs&gt;\\n&lt;g clip-path='url(#cpMzQuNjV8NjQ3LjQ3fDUuNDh8NTQ0LjI5)'&gt;\\n&lt;rect x='34.65' y='5.48' width='612.82' height='538.82' style='stroke-width: 1.07; stroke: none; fill: #EBEBEB;' /&gt;\\n&lt;polyline points='34.65,473.88 647.47,473.88 ' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='34.65,320.81 647.47,320.81 ' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='34.65,167.74 647.47,167.74 ' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='34.65,14.66 647.47,14.66 ' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='137.50,544.29 137.50,5.48 ' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='244.64,544.29 244.64,5.48 ' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='351.77,544.29 351.77,5.48 ' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='458.91,544.29 458.91,5.48 ' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='566.04,544.29 566.04,5.48 ' style='stroke-width: 0.53; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='34.65,397.35 647.47,397.35 ' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='34.65,244.27 647.47,244.27 ' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='34.65,91.20 647.47,91.20 ' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='83.93,544.29 83.93,5.48 ' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='191.07,544.29 191.07,5.48 ' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='298.20,544.29 298.20,5.48 ' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='405.34,544.29 405.34,5.48 ' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='512.47,544.29 512.47,5.48 ' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='619.61,544.29 619.61,5.48 ' style='stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;circle cx='255.35' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='298.20' cy='228.97' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='244.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='212.50' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='212.50' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='298.20' cy='274.89' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='276.78' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='233.92' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='233.92' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='233.92' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='212.50' cy='351.42' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='169.64' cy='397.35' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='473.88' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='169.64' cy='397.35' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='148.21' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='126.79' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='212.50' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='191.07' cy='351.42' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='212.50' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='169.64' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='489.19' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='473.88' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='169.64' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='341.06' cy='244.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='233.92' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='255.35' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='233.92' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='212.50' cy='366.73' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='212.50' cy='366.73' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='233.92' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='233.92' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='366.73' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='191.07' cy='382.04' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='212.50' cy='351.42' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='212.50' cy='351.42' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='169.64' cy='427.96' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='148.21' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='169.64' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='169.64' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='169.64' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='62.51' cy='519.80' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='105.36' cy='473.88' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='148.21' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='148.21' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='62.51' cy='519.80' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='148.21' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='458.57' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='148.21' cy='427.96' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='473.88' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='126.79' cy='458.57' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='62.51' cy='519.80' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='148.21' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='148.21' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='126.79' cy='458.57' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='62.51' cy='519.80' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='473.88' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='105.36' cy='458.57' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='148.21' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='473.88' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='105.36' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='105.36' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='126.79' cy='427.96' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='169.64' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='191.07' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='169.64' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='148.21' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='148.21' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='148.21' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='169.64' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='169.64' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='148.21' cy='458.57' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='148.21' cy='458.57' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='148.21' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='473.88' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='148.21' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='233.92' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='212.50' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='382.04' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='191.07' cy='366.73' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='191.07' cy='351.42' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='366.73' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='169.64' cy='397.35' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='469.62' cy='198.35' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='383.91' cy='213.66' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='405.34' cy='213.66' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='362.48' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='383.91' cy='213.66' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='426.77' cy='183.04' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='405.34' cy='152.43' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='383.91' cy='152.43' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='319.63' cy='244.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='228.97' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='274.89' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='276.78' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='298.20' cy='274.89' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='298.20' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='233.92' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='212.50' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='233.92' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='233.92' cy='366.73' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='397.35' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='169.64' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='62.51' cy='519.80' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='169.64' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='148.21' cy='427.96' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='489.19' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='473.88' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='126.79' cy='427.96' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='126.79' cy='427.96' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='473.88' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='105.36' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='105.36' cy='458.57' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='126.79' cy='427.96' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='169.64' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='148.21' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='148.21' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='148.21' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='362.48' cy='228.97' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='362.48' cy='213.66' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='276.78' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='276.78' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='169.64' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='191.07' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='169.64' cy='397.35' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='126.79' cy='427.96' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='212.50' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='233.92' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='274.89' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='212.50' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='255.35' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='298.20' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='276.78' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='298.20' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='255.35' cy='351.42' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='298.20' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='298.20' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='276.78' cy='320.81' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='298.20' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='397.35' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='212.50' cy='397.35' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='191.07' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='191.07' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='212.50' cy='397.35' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='169.64' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='319.63' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='319.63' cy='228.97' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='228.97' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='274.89' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='319.63' cy='228.97' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='341.06' cy='228.97' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='290.19' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='383.91' cy='244.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='383.91' cy='198.35' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='426.77' cy='167.74' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='469.62' cy='137.12' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='426.77' cy='167.74' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='105.36' cy='473.88' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='148.21' cy='427.96' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='397.35' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='212.50' cy='397.35' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='233.92' cy='366.73' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='191.07' cy='443.27' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='191.07' cy='412.65' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='191.07' cy='427.96' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='212.50' cy='397.35' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='341.06' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='233.92' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='576.76' cy='29.97' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='341.06' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='212.50' cy='351.42' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='233.92' cy='336.12' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='619.61' cy='29.97' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='491.05' cy='75.89' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='298.20' cy='274.89' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='298.20' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='276.78' cy='274.89' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='319.63' cy='259.58' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;circle cx='212.50' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='255.35' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #132B43; fill: #132B43;' /&gt;\\n&lt;circle cx='233.92' cy='305.50' r='1.95' style='stroke-width: 0.71; stroke: #56B1F7; fill: #56B1F7;' /&gt;\\n&lt;/g&gt;\\n&lt;g clip-path='url(#cpMC4wMHw3MjAuMDB8MC4wMHw1NzYuMDA=)'&gt;\\n&lt;text x='29.72' y='400.55' text-anchor='end' style='font-size: 8.80px;fill: #4D4D4D; font-family: \\\"Liberation Sans\\\";' textLength='11.19px' lengthAdjust='spacingAndGlyphs'&gt;20&lt;/text&gt;\\n&lt;text x='29.72' y='247.48' text-anchor='end' style='font-size: 8.80px;fill: #4D4D4D; font-family: \\\"Liberation Sans\\\";' textLength='11.19px' lengthAdjust='spacingAndGlyphs'&gt;30&lt;/text&gt;\\n&lt;text x='29.72' y='94.41' text-anchor='end' style='font-size: 8.80px;fill: #4D4D4D; font-family: \\\"Liberation Sans\\\";' textLength='11.19px' lengthAdjust='spacingAndGlyphs'&gt;40&lt;/text&gt;\\n&lt;polyline points='31.91,397.35 34.65,397.35 ' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='31.91,244.27 34.65,244.27 ' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='31.91,91.20 34.65,91.20 ' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='83.93,547.03 83.93,544.29 ' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='191.07,547.03 191.07,544.29 ' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='298.20,547.03 298.20,544.29 ' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='405.34,547.03 405.34,544.29 ' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='512.47,547.03 512.47,544.29 ' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' /&gt;\\n&lt;polyline points='619.61,547.03 619.61,544.29 ' style='stroke-width: 1.07; stroke: #333333; stroke-linecap: butt;' /&gt;\\n&lt;text x='83.93' y='555.64' text-anchor='middle' style='font-size: 8.80px;fill: #4D4D4D; font-family: \\\"Liberation Sans\\\";' textLength='11.19px' lengthAdjust='spacingAndGlyphs'&gt;10&lt;/text&gt;\\n&lt;text x='191.07' y='555.64' text-anchor='middle' style='font-size: 8.80px;fill: #4D4D4D; font-family: \\\"Liberation Sans\\\";' textLength='11.19px' lengthAdjust='spacingAndGlyphs'&gt;15&lt;/text&gt;\\n&lt;text x='298.20' y='555.64' text-anchor='middle' style='font-size: 8.80px;fill: #4D4D4D; font-family: \\\"Liberation Sans\\\";' textLength='11.19px' lengthAdjust='spacingAndGlyphs'&gt;20&lt;/text&gt;\\n&lt;text x='405.34' y='555.64' text-anchor='middle' style='font-size: 8.80px;fill: #4D4D4D; font-family: \\\"Liberation Sans\\\";' textLength='11.19px' lengthAdjust='spacingAndGlyphs'&gt;25&lt;/text&gt;\\n&lt;text x='512.47' y='555.64' text-anchor='middle' style='font-size: 8.80px;fill: #4D4D4D; font-family: \\\"Liberation Sans\\\";' textLength='11.19px' lengthAdjust='spacingAndGlyphs'&gt;30&lt;/text&gt;\\n&lt;text x='619.61' y='555.64' text-anchor='middle' style='font-size: 8.80px;fill: #4D4D4D; font-family: \\\"Liberation Sans\\\";' textLength='11.19px' lengthAdjust='spacingAndGlyphs'&gt;35&lt;/text&gt;\\n&lt;text x='341.06' y='568.23' text-anchor='middle' style='font-size: 11.00px; font-family: \\\"Liberation Sans\\\";' textLength='16.87px' lengthAdjust='spacingAndGlyphs'&gt;cty&lt;/text&gt;\\n&lt;text transform='translate(13.50,274.89) rotate(-90)' text-anchor='middle' style='font-size: 11.00px; font-family: \\\"Liberation Sans\\\";' textLength='22.48px' lengthAdjust='spacingAndGlyphs'&gt;hwy&lt;/text&gt;\\n&lt;rect x='658.42' y='218.31' width='56.10' height='113.15' style='stroke-width: 1.07; stroke: none; fill: #FFFFFF;' /&gt;\\n&lt;image width='17.28' height='86.40' x='663.90' y='239.58' preserveAspectRatio='none' xlink:href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAEsCAYAAAACUNnVAAAAmElEQVQ4ja2UQRLDMAgDd3hk/tnX5agcknFaCoa0vnkMCEnGsL12GQhDYDpPwoDrpBFlRDWi/9Wu6AHC9FkLYLrzlhD3oJ3mDvRHRYy7IC8A7bCK8gpWKYDzeQVArDcDyD2YAnSofZvzaOA6Q7Oahp/dmRuVTQ0xU5TGP2o8Waool1obVuv1q8qP9xPvg633XlGLDtfIhNUBcBeA5ss0BXMAAAAASUVORK5CYII='/&gt;\\n&lt;text x='686.66' y='319.48' style='font-size: 8.80px; font-family: \\\"Liberation Sans\\\";' textLength='22.38px' lengthAdjust='spacingAndGlyphs'&gt;2000&lt;/text&gt;\\n&lt;text x='686.66' y='300.34' style='font-size: 8.80px; font-family: \\\"Liberation Sans\\\";' textLength='22.38px' lengthAdjust='spacingAndGlyphs'&gt;2002&lt;/text&gt;\\n&lt;text x='686.66' y='281.21' style='font-size: 8.80px; font-family: \\\"Liberation Sans\\\";' textLength='22.38px' lengthAdjust='spacingAndGlyphs'&gt;2004&lt;/text&gt;\\n&lt;text x='686.66' y='262.07' style='font-size: 8.80px; font-family: \\\"Liberation Sans\\\";' textLength='22.38px' lengthAdjust='spacingAndGlyphs'&gt;2006&lt;/text&gt;\\n&lt;text x='686.66' y='242.93' style='font-size: 8.80px; font-family: \\\"Liberation Sans\\\";' textLength='22.38px' lengthAdjust='spacingAndGlyphs'&gt;2008&lt;/text&gt;\\n&lt;text x='663.90' y='232.96' style='font-size: 11.00px; font-family: \\\"Liberation Sans\\\";' textLength='24.54px' lengthAdjust='spacingAndGlyphs'&gt;year&lt;/text&gt;\\n&lt;line x1='663.90' y1='316.27' x2='667.36' y2='316.27' style='stroke-width: 0.38; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;line x1='663.90' y1='297.13' x2='667.36' y2='297.13' style='stroke-width: 0.38; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;line x1='663.90' y1='278.00' x2='667.36' y2='278.00' style='stroke-width: 0.38; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;line x1='663.90' y1='258.86' x2='667.36' y2='258.86' style='stroke-width: 0.38; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;line x1='663.90' y1='239.73' x2='667.36' y2='239.73' style='stroke-width: 0.38; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;line x1='677.73' y1='316.27' x2='681.18' y2='316.27' style='stroke-width: 0.38; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;line x1='677.73' y1='297.13' x2='681.18' y2='297.13' style='stroke-width: 0.38; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;line x1='677.73' y1='278.00' x2='681.18' y2='278.00' style='stroke-width: 0.38; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;line x1='677.73' y1='258.86' x2='681.18' y2='258.86' style='stroke-width: 0.38; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;line x1='677.73' y1='239.73' x2='681.18' y2='239.73' style='stroke-width: 0.38; stroke: #FFFFFF; stroke-linecap: butt;' /&gt;\\n&lt;/g&gt;\\n&lt;/svg&gt;\\n\"\n\nUse ggplot2 as a Clojure namespace:\n\n(r/require-r '[ggplot2 :as gg])\n\n\nnil\n\nThe mpg dataset as a Clojure (tech.ml.dataset) dataset:\n\ntoydata.ggplot/mpg\n\n\n_unnamed [234 11]:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n:manufacturer\n:model\n:displ\n:year\n:cyl\n:trans\n:drv\n:cty\n:hwy\n:fl\n:class\n\n\n\n\naudi\na4\n1.8\n1999\n4\nauto(l5)\nf\n18\n29\np\ncompact\n\n\naudi\na4\n1.8\n1999\n4\nmanual(m5)\nf\n21\n29\np\ncompact\n\n\naudi\na4\n2.0\n2008\n4\nmanual(m6)\nf\n20\n31\np\ncompact\n\n\naudi\na4\n2.0\n2008\n4\nauto(av)\nf\n21\n30\np\ncompact\n\n\naudi\na4\n2.8\n1999\n6\nauto(l5)\nf\n16\n26\np\ncompact\n\n\naudi\na4\n2.8\n1999\n6\nmanual(m5)\nf\n18\n26\np\ncompact\n\n\naudi\na4\n3.1\n2008\n6\nauto(av)\nf\n18\n27\np\ncompact\n\n\naudi\na4 quattro\n1.8\n1999\n4\nmanual(m5)\n4\n18\n26\np\ncompact\n\n\naudi\na4 quattro\n1.8\n1999\n4\nauto(l5)\n4\n16\n25\np\ncompact\n\n\naudi\na4 quattro\n2.0\n2008\n4\nmanual(m6)\n4\n20\n28\np\ncompact\n\n\n…\n…\n…\n…\n…\n…\n…\n…\n…\n…\n…\n\n\nvolkswagen\nnew beetle\n2.0\n1999\n4\nmanual(m5)\nf\n21\n29\nr\nsubcompact\n\n\nvolkswagen\nnew beetle\n2.0\n1999\n4\nauto(l4)\nf\n19\n26\nr\nsubcompact\n\n\nvolkswagen\nnew beetle\n2.5\n2008\n5\nmanual(m5)\nf\n20\n28\nr\nsubcompact\n\n\nvolkswagen\nnew beetle\n2.5\n2008\n5\nauto(s6)\nf\n20\n29\nr\nsubcompact\n\n\nvolkswagen\npassat\n1.8\n1999\n4\nmanual(m5)\nf\n21\n29\np\nmidsize\n\n\nvolkswagen\npassat\n1.8\n1999\n4\nauto(l5)\nf\n18\n29\np\nmidsize\n\n\nvolkswagen\npassat\n2.0\n2008\n4\nauto(s6)\nf\n19\n28\np\nmidsize\n\n\nvolkswagen\npassat\n2.0\n2008\n4\nmanual(m6)\nf\n21\n29\np\nmidsize\n\n\nvolkswagen\npassat\n2.8\n1999\n6\nauto(l5)\nf\n16\n26\np\nmidsize\n\n\nvolkswagen\npassat\n2.8\n1999\n6\nmanual(m5)\nf\n18\n26\np\nmidsize\n\n\nvolkswagen\npassat\n3.6\n2008\n6\nauto(s6)\nf\n17\n26\np\nmidsize\n\n\n\n\nEvaluating R code generated from the Clojure namespace, with Clojure data.\n\n(-&gt; toydata.ggplot/mpg\n    (gg/ggplot (gg/aes :x 'cty\n                       :y 'hwy\n                       :color 'year))\n    (r/r+ (gg/geom_point))\n    r\n    plotting/plot-&gt;buffered-image)\n\n\n\n\nRepresenting a ggplot plot as Clojure data:\n\n(-&gt; toydata.ggplot/mpg\n    (gg/ggplot (gg/aes :x 'cty\n                       :y 'hwy\n                       :color 'year))\n    (r/r+ (gg/geom_point))\n    r\n    representing/ggplot-&gt;clj\n    ;; (dissoc the dataset itself\n    ;; to keep the structure small)\n    (dissoc :data))\n\n\n{:layers\n [{:aes_params [],\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor [[$ .MEM x801cad4121d84055]],\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales {:scales [], :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy], :colour [~ year]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"], :colour [\"year\"]}}\n\nUsing log scale (keeping axis labels, changing the spacing):\n\n(-&gt; toydata.ggplot/mpg\n    (gg/ggplot (gg/aes :x 'cty\n                       :y 'hwy\n                       :color 'year))\n    (r/r+ (gg/geom_point :size 5)\n          (gg/scale_y_log10))\n    r\n    plotting/plot-&gt;svg\n    kind/html)\n\n\n\n\n  \n\n\n\n  \n    \n  \n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n20\n30\n40\n\n\n\n\n\n\n\n\n\n10\n15\n20\n25\n30\n35\ncty\nhwy\n\n\n2000\n2002\n2004\n2006\n2008\nyear\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nsource: projects/datavis/ggplot/notebooks/study_session_20240225.clj",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Code examples from study session 2024-02-25</span>"
    ]
  },
  {
    "objectID": "ggplotly.html",
    "href": "ggplotly.html",
    "title": "6  Rendering ggclj using htmlwidgets ggplotly",
    "section": "",
    "text": "This is part of the Scicloj Clojure Data Scrapbook.\n\n(ns ggplotly\n  (:require [scicloj.kindly.v4.kind :as kind]\n            [charred.api :as charred]\n            [clojure.math :as math]\n            [scicloj.ggclj.geom.point :as point]\n            [scicloj.ggclj.api :as gg]\n            [scicloj.metamorph.ml.toydata.ggplot :as toydata.ggplot]\n            [tablecloth.api :as tc]))\n\nHere we render plots through the JS client side of ggplotly - an R package (part of the htmlwidgets ecosystem) offering a Plotly fronted for ggplot2’s grammar of graphics implementation.\nThe following is a work-in-progress attempt to generate JSON specs of the kind consumed by ggplotly’s client side.\nThe following spec function was generaged by mimicking R’s ggplotlTentativey(ggplot(mtcars, aes(wt, mpg)) + geom_point())’s output. Therefore, some parts are hard-coded and require generalization. Other parts are still missing (e.g., specifying colours).\n\n(defn -&gt;ggplotly-spec [{:keys [layers labels]}]\n  (kind/htmlwidgets-ggplotly\n   (let [;; assuming one layer:\n         {:keys [data xmin xmax ymin ymax]} (first layers)\n         ;; an auxiliary function:\n         -&gt;tickvals (fn [l r]\n                      (let [jump (-&gt; (- r l)\n                                     (/ 6)\n                                     math/floor\n                                     int\n                                     (max 1))]\n                        (-&gt; l\n                            math/ceil\n                            (range r jump))))]\n     {:x\n      {:config\n       {:doubleClick \"reset\",\n        :modeBarButtonsToAdd [\"hoverclosest\" \"hovercompare\"],\n        :showSendToCloud false},\n       :layout\n       {:plot_bgcolor \"rgba(235,235,235,1)\",\n        :paper_bgcolor \"rgba(255,255,255,1)\",\n        :legend\n        {:bgcolor \"rgba(255,255,255,1)\",\n         :bordercolor \"transparent\",\n         :borderwidth 1.88976377952756,\n         :font {:color \"rgba(0,0,0,1)\", :family \"\", :size 11.689497716895}},\n        :xaxis (let [tickvals (-&gt;tickvals xmin xmax)\n                     ticktext (mapv str tickvals)\n                     range-len (- xmax xmin)\n                     range-expansion (* 0.1 range-len)\n                     expanded-range [(- xmin range-expansion)\n                                     (+ xmax range-expansion)]]\n                 {:linewidth 0,\n                  :nticks nil,\n                  :linecolor nil,\n                  :ticklen 3.65296803652968,\n                  :tickcolor \"rgba(51,51,51,1)\",\n                  :tickmode \"array\",\n                  :gridcolor \"rgba(255,255,255,1)\",\n                  :automargin true,\n                  :type \"linear\",\n                  :tickvals tickvals\n                  :zeroline false,\n                  :title\n                  {:text (:x labels),\n                   :font {:color \"rgba(0,0,0,1)\", :family \"\", :size 14.6118721461187}},\n                  :tickfont {:color \"rgba(77,77,77,1)\", :family \"\", :size 11.689497716895},\n                  :autorange false,\n                  :showticklabels true,\n                  :showline false,\n                  :showgrid true,\n                  :ticktext ticktext\n                  :ticks \"outside\",\n                  :gridwidth 0.66417600664176,\n                  :anchor \"y\",\n                  :domain [0 1],\n                  :hoverformat \".2f\",\n                  :tickangle 0,\n                  :tickwidth 0.66417600664176,\n                  :categoryarray ticktext,\n                  :categoryorder \"array\",\n                  :range expanded-range},)\n        :font {:color \"rgba(0,0,0,1)\", :family \"\", :size 14.6118721461187},\n        :showlegend false,\n        :barmode \"relative\",\n        :yaxis (let [tickvals (-&gt;tickvals ymin ymax)\n                     ticktext (mapv str tickvals)\n                     range-len (- ymax ymin)\n                     range-expansion (* 0.1 range-len)\n                     expanded-range [(- ymin range-expansion)\n                                     (+ ymax range-expansion)]]\n                 {:linewidth 0,\n                  :nticks nil,\n                  :linecolor nil,\n                  :ticklen 3.65296803652968,\n                  :tickcolor \"rgba(51,51,51,1)\",\n                  :tickmode \"array\",\n                  :gridcolor \"rgba(255,255,255,1)\",\n                  :automargin true,\n                  :type \"linear\",\n                  :tickvals tickvals,\n                  :zeroline false,\n                  :title\n                  {:text (:y labels),\n                   :font {:color \"rgba(0,0,0,1)\", :family \"\", :size 14.6118721461187}},\n                  :tickfont {:color \"rgba(77,77,77,1)\", :family \"\", :size 11.689497716895},\n                  :autorange false,\n                  :showticklabels true,\n                  :showline false,\n                  :showgrid true,\n                  :ticktext ticktext,\n                  :ticks \"outside\",\n                  :gridwidth 0.66417600664176,\n                  :anchor \"x\",\n                  :domain [0 1],\n                  :hoverformat \".2f\",\n                  :tickangle 0,\n                  :tickwidth 0.66417600664176,\n                  :categoryarray ticktext,\n                  :categoryorder \"array\",\n                  :range expanded-range},)\n        :hovermode \"closest\",\n        :margin\n        {:t 25.7412480974125,\n         :r 7.30593607305936,\n         :b 39.6955859969559,\n         :l 37.2602739726027},\n        :shapes\n        [{:yref \"paper\",\n          :fillcolor nil,\n          :xref \"paper\",\n          :y1 1,\n          :type \"rect\",\n          :line {:color nil, :width 0, :linetype []},\n          :y0 0,\n          :x1 1,\n          :x0 0}]},\n       :highlight\n       {:on \"plotly_click\"\n        :persistent false,\n        :dynamic false,\n        :selectize false,\n        :opacityDim 0.2,\n        :selected {:opacity 1},\n        :debounce 0},\n       :base_url \"https://plot.ly\",\n       :cur_data \"1f2fea5b54d146\",\n       :source \"A\",\n       :shinyEvents\n       [\"plotly_hover\"\n        \"plotly_click\"\n        \"plotly_selected\"\n        \"plotly_relayout\"\n        \"plotly_brushed\"\n        \"plotly_brushing\"\n        \"plotly_clickannotation\"\n        \"plotly_doubleclick\"\n        \"plotly_deselect\"\n        \"plotly_afterplot\"\n        \"plotly_sunburstclick\"],\n       :attrs {:1f2fea5b54d146 {:x {}, :y {}, :type \"scatter\"}},\n       :data\n       [{:y (:y data)\n         :hoveron \"points\",\n         :frame nil,\n         :hoverinfo \"text\",\n         :marker\n         {:autocolorscale false,\n          :color \"rgba(0,0,0,1)\",\n          :opacity 1,\n          :size 5.66929133858268,\n          :symbol \"circle\",\n          :line {:width 1.88976377952756, :color \"rgba(0,0,0,1)\"}},\n         :mode \"markers\",\n         :type \"scatter\",\n         :xaxis \"x\",\n         :showlegend false,\n         :yaxis \"y\",\n         :x (:x data)\n         :text (-&gt; data\n                   (tc/select-columns [:x :y])\n                   (tc/rows :as-maps)\n                   (-&gt;&gt; (mapv pr-str)))}]},\n      :evals [],\n      :jsHooks []})))\n\nNow here is how we can display a ggclj structure as a ggplotly plot.\n\n(defn ggplotly [ggplot]\n  (-&gt; ggplot\n      gg/ggplot-build\n      -&gt;ggplotly-spec))\n\nLet us try it with ggplot’s mpg dataset.\n\n(-&gt; toydata.ggplot/mpg\n    (gg/ggplot (gg/aes :displ :hwy))\n    (point/geom-point)\n    ggplotly)\n\n\n\nsource: projects/datavis/ggplot/notebooks/ggplotly.clj",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Rendering ggclj using htmlwidgets ggplotly</span>"
    ]
  },
  {
    "objectID": "ggplotly_cont.html",
    "href": "ggplotly_cont.html",
    "title": "7  Further exploring ggplotly’s client side",
    "section": "",
    "text": "(ns ggplotly-cont\n  (:require [tablecloth.api :as tc]\n            [scicloj.metamorph.ml.toydata.ggplot :as toydata.ggplot]\n            [tech.v3.datatype.functional :as fun]\n            [scicloj.kindly.v4.kind :as kind]\n            [clojure.string :as str]\n            [clojure.math :as math]\n            [clojure2d.color :as color]\n            [tablecloth.column.api :as tcc]))\n\nThe following template was generated from the JSON file in the HTML generated by ggplotly(ggplot(mpg, aes(x=hwy, y=displ, color=factor(cyl))) + geom_point() + geom_smooth(method=\"lm\")) and then gradually generalizing it as a set of Clojure functions. This is a work-in-progress draft. Some parts are still hard-coded (e.g., colours).\n\n(defn layer [{:keys [type x y color text name legendgroup showlegend]}]\n  (merge {:hoveron \"points\",\n          :legendgroup legendgroup,\n          :showlegend showlegend\n          :frame nil,\n          :hoverinfo \"text\",\n          :name name,\n          :mode (case type\n                  :point \"markers\"\n                  :line \"lines\")\n          :type \"scatter\",\n\n          :xaxis \"x\",\n          :yaxis \"y\",\n          :x (vec x)\n          :y (vec y)\n          :text (vec text)}\n         (case type\n           :point {:marker {:autocolorscale false,\n                            :color color,\n                            :opacity 1,\n                            :size 5.66929133858268,\n                            :symbol \"circle\",\n                            :line {:width 1.88976377952756, :color color}}}\n           :line {:line {:width 3.77952755905512,\n                         :color color,\n                         :dash \"solid\"}})))\n\n\n(def colors\n  (-&gt;&gt; :category10\n       color/palette\n       (mapv (fn [[r g b a]]\n               (format \"rgba(%d,%d,%d,%f)\"\n                       (int r)\n                       (int g)\n                       (int b)\n                       (/ a 255.0))))))\n\n\n(def config\n  {:doubleClick \"reset\",\n   :modeBarButtonsToAdd [\"hoverclosest\" \"hovercompare\"],\n   :showSendToCloud false},)\n\n\n(def highlight\n  {:on \"plotly_click\",\n   :persistent false,\n   :dynamic false,\n   :selectize false,\n   :opacityDim 0.2,\n   :selected {:opacity 1},\n   :debounce 0},)\n\n\n(defn texts [ds column-names]\n  (-&gt; ds\n      (tc/select-columns column-names)\n      tc/rows\n      (-&gt;&gt; (map (fn [row]\n                  (str/join \"&lt;br /&gt;\"\n                            (map (partial format \"%s: %s\")\n                                 column-names row)))))))\n\n\n(defn -&gt;tickvals [l r]\n  (let [jump (-&gt; (- r l)\n                 (/ 6)\n                 math/floor\n                 int\n                 (max 1))]\n    (-&gt; l\n        math/ceil\n        (range r jump))))\n\n\n(defn axis [{:keys [minval maxval anchor title]}]\n  (let [tickvals (-&gt;tickvals minval maxval)\n        ticktext (mapv str tickvals)\n        range-len (- maxval minval)\n        range-expansion (* 0.1 range-len)\n        expanded-range [(- minval range-expansion)\n                        (+ maxval range-expansion)]]\n    {:linewidth 0,\n     :ticklen 3.65296803652968,\n     :tickcolor \"rgba(51,51,51,1)\",\n     :tickmode \"array\",\n     :gridcolor \"rgba(255,255,255,1)\",\n     :automargin true,\n     :type \"linear\",\n     :tickvals tickvals,\n     :zeroline false,\n     :title\n     {:text title,\n      :font {:color \"rgba(0,0,0,1)\", :family \"\", :size 14.6118721461187}},\n     :tickfont {:color \"rgba(77,77,77,1)\", :family \"\", :size 11.689497716895},\n     :autorange false,\n     :showticklabels true,\n     :showline false,\n     :showgrid true,\n     :ticktext ticktext,\n     :ticks \"outside\",\n     :gridwidth 0.66417600664176,\n     :anchor \"y\",\n     :domain [0 1],\n     :hoverformat \".2f\",\n     :tickangle 0,\n     :tickwidth 0.66417600664176,\n     :categoryarray ticktext,\n     :categoryorder \"array\",\n     :range expanded-range},))\n\n\n(defn layout [{:keys [xaxis yaxis]}]\n  {:plot_bgcolor \"rgba(235,235,235,1)\",\n   :paper_bgcolor \"rgba(255,255,255,1)\",\n   :legend {:bgcolor \"rgba(255,255,255,1)\",\n            :bordercolor \"transparent\",\n            :borderwidth 1.88976377952756,\n            :font {:color \"rgba(0,0,0,1)\", :family \"\", :size 11.689497716895},\n            :title {:text \"factor(cyl)\",\n                    :font {:color \"rgba(0,0,0,1)\", :family \"\", :size 14.6118721461187}}},\n   :font {:color \"rgba(0,0,0,1)\", :family \"\", :size 14.6118721461187},\n   :showlegend true,\n   :barmode \"relative\",\n   :hovermode \"closest\",\n   :margin\n   {:t 25.7412480974125,\n    :r 7.30593607305936,\n    :b 39.6955859969559,\n    :l 31.4155251141553},\n   :shapes [{:yref \"paper\",\n             :fillcolor nil,\n             :xref \"paper\",\n             :y1 1,\n             :type \"rect\",\n             :line {:color nil, :width 0, :linetype []},\n             :y0 0,\n             :x1 1,\n             :x0 0}]\n   :xaxis xaxis\n   :yaxis yaxis})\n\n\n(delay\n  (let [data toydata.ggplot/mpg\n        point-layers (-&gt; data\n                         (tc/add-column \"factor(cyl)\" #(:cyl %))\n                         (tc/group-by :cyl {:result-type :as-map})\n                         (-&gt;&gt; (sort-by key)\n                              (map-indexed\n                               (fn [i [group-name group-data]]\n                                 (let [base {:x (:hwy group-data),\n                                             :y (:displ group-data)\n                                             :color (colors i)\n                                             :name group-name\n                                             :legendgroup group-name}\n                                       predictions (map\n                                                    (fun/linear-regressor (:hwy group-data)\n                                                                          (:displ group-data))\n                                                    (:hwy group-data))]\n                                   [(-&gt; base\n                                        (assoc :type :point\n                                               :showlegend true\n                                               :y (:displ group-data)\n                                               :text (-&gt; group-data\n                                                         (texts [:hwy :displ \"factor(cyl)\"])))\n                                        layer)\n                                    (-&gt; base\n                                        (assoc :type :line\n                                               :showlegend false\n                                               :y predictions\n                                               :text (-&gt; group-data\n                                                         ;; (tc/add-column :displ predictions)\n                                                         (texts [:hwy :displ \"factor(cyl)\"])))\n                                        layer)])))\n                              (apply concat)))\n        xmin (-&gt; data :hwy tcc/reduce-min)\n        xmax (-&gt; data :hwy tcc/reduce-max)\n        ymin (-&gt; data :displ tcc/reduce-min)\n        ymax (-&gt; data :displ tcc/reduce-max)\n        xaxis (axis {:minval xmin\n                     :maxval xmax\n                     :anchor \"x\"\n                     :title :hwy})\n        yaxis (axis {:minval ymin\n                     :maxval ymax\n                     :anchor \"x\"\n                     :title :displ})]\n    (kind/htmlwidgets-ggplotly\n     {:x\n      {:config config\n       :highlight highlight\n       :base_url \"https://plot.ly\",\n       :layout (layout {:xaxis xaxis\n                        :yaxis yaxis})\n       :data point-layers},\n      :evals [],\n      :jsHooks []})))\n\n\n\nsource: projects/datavis/ggplot/notebooks/ggplotly_cont.clj",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Further exploring ggplotly's client side</span>"
    ]
  },
  {
    "objectID": "combining_tablecloth_and_hanami.html",
    "href": "combining_tablecloth_and_hanami.html",
    "title": "Exploring ggplot",
    "section": "",
    "text": "(ns combining-tablecloth-and-hanami\n  (:require [scicloj.kindly.v4.kind :as kind]\n            [scicloj.noj.v1.paths :as paths]\n            [scicloj.tempfiles.api :as tempfiles]\n            [tablecloth.api :as tc]\n            [tech.v3.dataset :as ds]\n            [aerial.hanami.common :as hc]\n            [aerial.hanami.templates :as ht]\n            [scicloj.metamorph.ml.toydata :as toydata]))\n\n\n(defn invoke [[f arg]]\n  (f arg))\n\n\n(defn prepare-data [dataset]\n  (when dataset\n    (let [{:keys [path _]}\n          (tempfiles/tempfile! \".csv\")]\n      (-&gt; dataset\n          (ds/write! path))\n      {:values (slurp path)\n       :format {:type \"csv\"}})))\n\n\n(defn safe-update [m k f]\n  (if (m k)\n    (update m k f)\n    m))\n\n\n(defn layered-xform [{:keys [template args]}]\n  (-&gt; template\n      (safe-update :layer\n                   (partial\n                    mapv\n                    (fn [layer]\n                      (-&gt; layer\n                          (update :template\n                                  (partial merge (dissoc template\n                                                         :layer\n                                                         :metamorph/data)))\n                          (update :args\n                                  (partial merge args))\n                          layered-xform))))\n      (update :metamorph/data prepare-data)\n      (hc/xform args)\n      (update-keys #(case % :metamorph/data :data %))\n      kind/vega-lite))\n\n\n(defn svg-rendered [vega-lite-template]\n  (assoc vega-lite-template\n         :usermeta\n         {:embedOptions {:renderer :svg}}))\n\n\n(def point-chart\n  (svg-rendered ht/point-chart))\n\n\n(def line-chart\n  (svg-rendered ht/line-chart))\n\n\n(defn plot\n  ([dataset template args]\n   (plot (assoc template\n                :metamorph/data dataset)\n         args))\n  ([template args]\n   (let [dataset (:metamorph/data template)]\n     (if (tc/grouped? dataset)\n       (-&gt; dataset\n           (tc/aggregate {:plot (fn [group-dataset]\n                                  [(plot (assoc template\n                                                :metamorph/data group-dataset)\n                                         args)])})\n           (tc/rename-columns {:plot-0 :plot})\n           kind/table)\n       ;; else\n       (kind/fn [layered-xform\n                 {:template template\n                  :args args}])))))\n\n\n(defn layer\n  ([context template args]\n   (if (tc/dataset? context)\n     (layer (plot context {} {})\n            template\n            args)\n     (-&gt; context\n         (update\n          1\n          update\n          :template\n          update\n          :layer\n          (comp vec conj)\n          {:template template\n           :args args})))))\n\n\n(-&gt; (toydata/iris-ds)\n    (plot point-chart\n          {:X :sepal_width\n           :Y :sepal_length}))\n\n\n\n(-&gt; (toydata/iris-ds)\n    (plot {}\n          {:TITLE \"dummy\"\n           :MCOLOR \"green\"})\n    (layer point-chart\n           {:X :sepal_width\n            :Y :sepal_length\n            :MSIZE 100})\n    (layer line-chart\n           {:X :sepal_width\n            :Y :sepal_length\n            :MSIZE 4\n            :MCOLOR \"brown\"}))\n\n\n\nsource: projects/datavis/ggplot/notebooks/combining_tablecloth_and_hanami.clj",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>combining_tablecloth_and_hanami.html</span>"
    ]
  },
  {
    "objectID": "draft.html",
    "href": "draft.html",
    "title": "9  Draft explorations",
    "section": "",
    "text": "(ns draft\n  (:require [clojisr.v1.r :as r :refer [r r$ r-&gt;clj]]\n            [clojisr.v1.applications.plotting :as plotting]\n            [representing]))\n\n\n(delay\n  (-&gt; \"(ggplot(mpg, aes(cty, hwy)))\"\n      r\n      representing/ggplot-&gt;clj\n      (dissoc :data)))\n\n\n{:layers [],\n :scales {:super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"]}}\n\n\n(delay\n  (-&gt; \"(ggplot(mpg, aes(cty, hwy)))\"\n      r\n      representing/ggplot-&gt;clj\n      (dissoc :data)))\n\n\n{:layers [],\n :scales {:super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"]}}\n\n\n(delay\n  (-&gt; \"(ggplot(mpg, mapping=aes(x=cty, y=hwy)))\"\n      r\n      representing/ggplot-&gt;clj\n      (dissoc :data)))\n\n\n{:layers [],\n :scales {:super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"]}}\n\n\n(delay\n  (-&gt; \"(ggplot(mpg, mapping=aes(x=cty, y=hwy))\n      + geom_point(mapping=aes(color=cyl), size=5)\n      + ylim(c(20,30)))\"\n      r\n      representing/ggplot-&gt;clj\n      (dissoc :data)))\n\n\n{:layers\n [{:aes_params {:size [5.0]},\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping {:colour [~ cyl]},\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor {: nil, :mapping {: nil, :color cyl}, :size [5.0]},\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales\n {:scales\n  [{:labels [],\n    :scale_name [\"position_c\"],\n    :breaks [],\n    :call\n    {:labels labels,\n     :scale_name [\"position_c\"],\n     :breaks breaks,\n     :name name,\n     :palette identity,\n     :super ScaleContinuousPosition,\n     :guide guide,\n     :minor_breaks minor_breaks,\n     :n.breaks n.breaks,\n     : nil,\n     :aesthetics [$ ggplot_global y_aes],\n     :na.value na.value,\n     :trans trans,\n     :oob oob,\n     :position position,\n     :limits limits,\n     :expand expand},\n    :rescaler :ggproto-method,\n    :name [],\n    :palette :ggproto-method,\n    :super :ggproto-method,\n    :guide [],\n    :minor_breaks [],\n    :n.breaks nil,\n    :aesthetics\n    [\"y\"\n     \"ymin\"\n     \"ymax\"\n     \"yend\"\n     \"yintercept\"\n     \"ymin_final\"\n     \"ymax_final\"\n     \"lower\"\n     \"middle\"\n     \"upper\"\n     \"y0\"],\n    :na.value [nil],\n    :trans\n    {:name [\"identity\"],\n     :transform\n     \"function (x) \\nx\\n&lt;bytecode: 0x5915e0f1c140&gt;\\n&lt;environment: namespace:base&gt;\\n\",\n     :inverse\n     \"function (x) \\nx\\n&lt;bytecode: 0x5915e0f1c140&gt;\\n&lt;environment: namespace:base&gt;\\n\",\n     :breaks\n     \"function (x, n = n_default) \\n{\\n    x &lt;- x[is.finite(x)]\\n    if (length(x) == 0) {\\n        return(numeric())\\n    }\\n    rng &lt;- range(x)\\n    labeling::extended(rng[1], rng[2], n, ...)\\n}\\n&lt;bytecode: 0x5915e50312c0&gt;\\n&lt;environment: 0x5915f0120fa8&gt;\\n\",\n     :minor_breaks\n     \"function (b, limits, n) \\n{\\n    b &lt;- b[!is.na(b)]\\n    if (length(b) &lt; 2) {\\n        return()\\n    }\\n    bd &lt;- diff(b)[1]\\n    if (!reverse) {\\n        if (min(limits) &lt; min(b)) \\n            b &lt;- c(b[1] - bd, b)\\n        if (max(limits) &gt; max(b)) \\n            b &lt;- c(b, b[length(b)] + bd)\\n    }\\n    else {\\n        if (max(limits) &gt; max(b)) \\n            b &lt;- c(b[1] - bd, b)\\n        if (min(limits) &lt; min(b)) \\n            b &lt;- c(b, b[length(b)] + bd)\\n    }\\n    seq_between &lt;- function(a, b) {\\n        seq(a, b, length.out = n + 1)[-(n + 1)]\\n    }\\n    breaks &lt;- unlist(Map(seq_between, b[-length(b)], b[-1]))\\n    breaks &lt;- c(breaks, b[length(b)])\\n    breaks\\n}\\n&lt;bytecode: 0x5915e5034ca0&gt;\\n&lt;environment: 0x5915f0120e20&gt;\\n\",\n     :format\n     \"function (x) \\n{\\n    if (!is.null(names(x))) {\\n        return(names(x))\\n    }\\n    ret &lt;- format(x, ..., trim = TRUE, justify = \\\"left\\\")\\n    ret[is.na(x)] &lt;- NA\\n    ret\\n}\\n&lt;bytecode: 0x5915e503e018&gt;\\n&lt;environment: 0x5915f0124b00&gt;\\n\",\n     :domain [##-Inf ##Inf]},\n    :oob :ggproto-method,\n    :position [\"left\"],\n    :limits [20.0 30.0],\n    :expand [],\n    :range {:super :ggproto-method}}],\n  :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"], :colour [\"cyl\"]}}\n\n\n(delay\n  (-&gt; \"(ggplot(mpg, mapping=aes(x=cty, y=hwy))\n      + geom_point(mapping=aes(color=factor(cyl)), size=20))\"\n      r\n      plotting/plot-&gt;buffered-image))\n\n\n\n\n\n(delay\n  (-&gt; \"(ggplot(mpg, mapping=aes(x=cty, y=hwy))\n      + geom_point(mapping=aes(color=cyl), size=5)\n      + ylim(c(20,30))\n      + scale_x_log10())\"\n      r\n      representing/ggplot-&gt;clj\n      (dissoc :data)))\n\n\n{:layers\n [{:aes_params {:size [5.0]},\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping {:colour [~ cyl]},\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor {: nil, :mapping {: nil, :color cyl}, :size [5.0]},\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales\n {:scales\n  [{:range {:super :ggproto-method}, :super :ggproto-method}\n   {:labels [],\n    :scale_name [\"position_c\"],\n    :breaks [],\n    :call\n    {:labels labels,\n     :scale_name [\"position_c\"],\n     :breaks breaks,\n     :name name,\n     :palette identity,\n     :super ScaleContinuousPosition,\n     :guide guide,\n     :minor_breaks minor_breaks,\n     :n.breaks n.breaks,\n     : nil,\n     :aesthetics [$ ggplot_global x_aes],\n     :na.value na.value,\n     :trans trans,\n     :oob oob,\n     :position position,\n     :limits limits,\n     :expand expand},\n    :rescaler :ggproto-method,\n    :name [],\n    :palette :ggproto-method,\n    :super :ggproto-method,\n    :guide [],\n    :minor_breaks [],\n    :n.breaks nil,\n    :aesthetics\n    [\"x\"\n     \"xmin\"\n     \"xmax\"\n     \"xend\"\n     \"xintercept\"\n     \"xmin_final\"\n     \"xmax_final\"\n     \"xlower\"\n     \"xmiddle\"\n     \"xupper\"\n     \"x0\"],\n    :na.value [nil],\n    :trans\n    {:name [\"log-10\"],\n     :transform\n     \"function (x) \\nlog(x, base)\\n&lt;bytecode: 0x5915eac600a8&gt;\\n&lt;environment: 0x5915e862b068&gt;\\n\",\n     :inverse\n     \"function (x) \\nbase^x\\n&lt;bytecode: 0x5915eac601f8&gt;\\n&lt;environment: 0x5915e862b068&gt;\\n\",\n     :breaks\n     \"function (x, n = n_default) \\n{\\n    raw_rng &lt;- suppressWarnings(range(x, na.rm = TRUE))\\n    if (any(!is.finite(raw_rng))) {\\n        return(numeric())\\n    }\\n    rng &lt;- log(raw_rng, base = base)\\n    min &lt;- floor(rng[1])\\n    max &lt;- ceiling(rng[2])\\n    if (max == min) {\\n        return(base^min)\\n    }\\n    by &lt;- floor((max - min)/n) + 1\\n    breaks &lt;- base^seq(min, max, by = by)\\n    relevant_breaks &lt;- base^rng[1] &lt;= breaks & breaks &lt;= base^rng[2]\\n    if (sum(relevant_breaks) &gt;= (n - 2)) {\\n        return(breaks)\\n    }\\n    while (by &gt; 1) {\\n        by &lt;- by - 1\\n        breaks &lt;- base^seq(min, max, by = by)\\n        relevant_breaks &lt;- base^rng[1] &lt;= breaks & breaks &lt;= \\n            base^rng[2]\\n        if (sum(relevant_breaks) &gt;= (n - 2)) {\\n            return(breaks)\\n        }\\n    }\\n    log_sub_breaks(rng, n = n, base = base)\\n}\\n&lt;bytecode: 0x5915eac53b68&gt;\\n&lt;environment: 0x5915e862b698&gt;\\n\",\n     :minor_breaks\n     \"function (b, limits, n) \\n{\\n    b &lt;- b[!is.na(b)]\\n    if (length(b) &lt; 2) {\\n        return()\\n    }\\n    bd &lt;- diff(b)[1]\\n    if (!reverse) {\\n        if (min(limits) &lt; min(b)) \\n            b &lt;- c(b[1] - bd, b)\\n        if (max(limits) &gt; max(b)) \\n            b &lt;- c(b, b[length(b)] + bd)\\n    }\\n    else {\\n        if (max(limits) &gt; max(b)) \\n            b &lt;- c(b[1] - bd, b)\\n        if (min(limits) &lt; min(b)) \\n            b &lt;- c(b, b[length(b)] + bd)\\n    }\\n    seq_between &lt;- function(a, b) {\\n        seq(a, b, length.out = n + 1)[-(n + 1)]\\n    }\\n    breaks &lt;- unlist(Map(seq_between, b[-length(b)], b[-1]))\\n    breaks &lt;- c(breaks, b[length(b)])\\n    breaks\\n}\\n&lt;bytecode: 0x5915e5034ca0&gt;\\n&lt;environment: 0x5915e862f0a0&gt;\\n\",\n     :format\n     \"function (x) \\n{\\n    if (!is.null(names(x))) {\\n        return(names(x))\\n    }\\n    ret &lt;- format(x, ..., trim = TRUE, justify = \\\"left\\\")\\n    ret[is.na(x)] &lt;- NA\\n    ret\\n}\\n&lt;bytecode: 0x5915e503e018&gt;\\n&lt;environment: 0x5915e862ef50&gt;\\n\",\n     :domain [1.0E-100 ##Inf]},\n    :oob :ggproto-method,\n    :position [\"bottom\"],\n    :limits nil,\n    :expand [],\n    :range {:super :ggproto-method}}],\n  :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"], :colour [\"cyl\"]}}\n\n\n(delay\n  (-&gt; \"(ggplot(mpg, mapping=aes(x=cty, y=hwy))\n      + geom_point(mapping=aes(color=cyl), size=5)\n      + ylim(c(20,30))\n      + scale_x_log10()\n      + theme_linedraw())\"\n      r\n      representing/ggplot-&gt;clj\n      (dissoc :data)))\n\n\n{:layers\n [{:aes_params {:size [5.0]},\n   :stat {:compute_layer :ggproto-method, :super :ggproto-method},\n   :show.legend [nil],\n   :mapping {:colour [~ cyl]},\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false]},\n   :geom\n   {:non_missing_aes [\"size\" \"shape\" \"colour\"],\n    :draw_key :ggproto-method,\n    :default_aes\n    {:shape [19.0],\n     :colour [\"black\"],\n     :size [1.5],\n     :fill [nil],\n     :alpha [nil],\n     :stroke [0.5]},\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method},\n   :stat_params {:na.rm [false]},\n   :constructor {: nil, :mapping {: nil, :color cyl}, :size [5.0]},\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales\n {:scales\n  [{:range {:super :ggproto-method}, :super :ggproto-method}\n   {:range {:super :ggproto-method}, :super :ggproto-method}],\n  :super :ggproto-method},\n :mapping {:x [~ cty], :y [~ hwy]},\n :theme\n {:axis.ticks\n  {:colour [\"black\"],\n   :linewidth [0.5],\n   :linetype nil,\n   :lineend nil,\n   :arrow [false],\n   :inherit.blank [true]},\n  :legend.justification [\"center\"],\n  :panel.grid.minor\n  {:colour nil,\n   :linewidth [0.05],\n   :linetype nil,\n   :lineend nil,\n   :arrow [false],\n   :inherit.blank [true]},\n  :strip.text.x.bottom nil,\n  :legend.key.width nil,\n  :panel.spacing.x nil,\n  :axis.text.y\n  {:hjust [1.0],\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size nil,\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust nil,\n   :margin [0.0 2.2 0.0 0.0]},\n  :panel.ontop [false],\n  :axis.ticks.x.top nil,\n  :panel.border\n  {:fill [nil],\n   :colour [\"black\"],\n   :linewidth [1.0],\n   :linetype nil,\n   :inherit.blank [true]},\n  :legend.key.height nil,\n  :plot.caption\n  {:hjust [1.0],\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size [0.8],\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust [1.0],\n   :margin [5.5 0.0 0.0 0.0]},\n  :panel.grid.major.y nil,\n  :panel.grid\n  {:colour [\"black\"],\n   :linewidth nil,\n   :linetype nil,\n   :lineend nil,\n   :arrow [false],\n   :inherit.blank [true]},\n  :axis.ticks.x.bottom nil,\n  :panel.grid.major.x nil,\n  :plot.tag\n  {:hjust [0.5],\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size [1.2],\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust [0.5],\n   :margin nil},\n  :axis.text\n  {:hjust nil,\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size [0.8],\n   :face nil,\n   :lineheight nil,\n   :colour [\"black\"],\n   :vjust nil,\n   :margin nil},\n  :axis.line.x nil,\n  :panel.spacing.y nil,\n  :legend.spacing.x nil,\n  :axis.text.x\n  {:hjust nil,\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size nil,\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust [1.0],\n   :margin [2.2 0.0 0.0 0.0]},\n  :axis.line.y.left nil,\n  :plot.caption.position [\"panel\"],\n  :plot.subtitle\n  {:hjust [0.0],\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size nil,\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust [1.0],\n   :margin [0.0 0.0 5.5 0.0]},\n  :axis.ticks.y.right nil,\n  :legend.box nil,\n  :strip.text.y\n  {:hjust nil,\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle [-90.0],\n   :size nil,\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust nil,\n   :margin nil},\n  :panel.spacing [5.5],\n  :legend.background\n  {:fill nil,\n   :colour [nil],\n   :linewidth nil,\n   :linetype nil,\n   :inherit.blank [true]},\n  :strip.switch.pad.grid [2.75],\n  :axis.ticks.length.y.left nil,\n  :legend.direction nil,\n  :strip.text\n  {:hjust nil,\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size [0.8],\n   :face nil,\n   :lineheight nil,\n   :colour [\"white\"],\n   :vjust nil,\n   :margin [4.4 4.4 4.4 4.4]},\n  :axis.line.x.bottom nil,\n  :axis.ticks.length.x.bottom nil,\n  :axis.text.y.left nil,\n  :axis.ticks.length.x nil,\n  :plot.margin [5.5 5.5 5.5 5.5],\n  :axis.ticks.length [2.75],\n  :plot.title\n  {:hjust [0.0],\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size [1.2],\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust [1.0],\n   :margin [0.0 0.0 5.5 0.0]},\n  :axis.ticks.y nil,\n  :legend.text.align nil,\n  :legend.text\n  {:hjust nil,\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size [0.8],\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust nil,\n   :margin nil},\n  :legend.key\n  {:fill [\"white\"],\n   :colour [nil],\n   :linewidth nil,\n   :linetype nil,\n   :inherit.blank [true]},\n  :axis.line.y nil,\n  :axis.title.y.left nil,\n  :axis.ticks.length.x.top nil,\n  :legend.box.margin [0.0 0.0 0.0 0.0],\n  :axis.title.y.right\n  {:hjust nil,\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle [-90.0],\n   :size nil,\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust [0.0],\n   :margin [0.0 0.0 0.0 2.75]},\n  :title nil,\n  :strip.clip [\"inherit\"],\n  :strip.background.x nil,\n  :strip.text.x nil,\n  :strip.placement [\"inside\"],\n  :axis.ticks.x nil,\n  :axis.line.y.right nil,\n  :axis.title.x.bottom nil,\n  :legend.key.size [1.2],\n  :axis.text.x.top\n  {:hjust nil,\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size nil,\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust [0.0],\n   :margin [0.0 0.0 2.2 0.0]},\n  :panel.background\n  {:fill [\"white\"],\n   :colour [nil],\n   :linewidth nil,\n   :linetype nil,\n   :inherit.blank [true]},\n  :plot.tag.position [\"topleft\"],\n  :legend.margin [5.5 5.5 5.5 5.5],\n  :plot.title.position [\"panel\"],\n  :line\n  {:colour [\"black\"],\n   :linewidth [0.5],\n   :linetype [1.0],\n   :lineend [\"butt\"],\n   :arrow [false],\n   :inherit.blank [true]},\n  :strip.text.y.left\n  {:hjust nil,\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle [90.0],\n   :size nil,\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust nil,\n   :margin nil},\n  :strip.background\n  {:fill [\"black\"],\n   :colour nil,\n   :linewidth nil,\n   :linetype nil,\n   :inherit.blank [true]},\n  :axis.title.y\n  {:hjust nil,\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle [90.0],\n   :size nil,\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust [1.0],\n   :margin [0.0 2.75 0.0 0.0]},\n  :legend.box.background [],\n  :panel.grid.major\n  {:colour nil,\n   :linewidth [0.1],\n   :linetype nil,\n   :lineend nil,\n   :arrow [false],\n   :inherit.blank [true]},\n  :axis.title nil,\n  :strip.text.y.right nil,\n  :legend.title.align nil,\n  :plot.background\n  {:fill nil,\n   :colour [\"white\"],\n   :linewidth nil,\n   :linetype nil,\n   :inherit.blank [true]},\n  :aspect.ratio nil,\n  :legend.spacing [11.0],\n  :axis.title.x\n  {:hjust nil,\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size nil,\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust [1.0],\n   :margin [2.75 0.0 0.0 0.0]},\n  :axis.line.x.top nil,\n  :legend.position [\"right\"],\n  :axis.ticks.length.y nil,\n  :axis.ticks.y.left nil,\n  :axis.ticks.length.y.right nil,\n  :legend.box.just nil,\n  :legend.title\n  {:hjust [0.0],\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size nil,\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust nil,\n   :margin nil},\n  :axis.text.y.right\n  {:hjust [0.0],\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size nil,\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust nil,\n   :margin [0.0 0.0 0.0 2.2]},\n  :axis.text.x.bottom nil,\n  :strip.background.y nil,\n  :axis.line [],\n  :rect\n  {:fill [\"white\"],\n   :colour [\"black\"],\n   :linewidth [0.5],\n   :linetype [1.0],\n   :inherit.blank [true]},\n  :legend.box.spacing [11.0],\n  :panel.grid.minor.y nil,\n  :panel.grid.minor.x nil,\n  :strip.switch.pad.wrap [2.75],\n  :axis.title.x.top\n  {:hjust nil,\n   :family nil,\n   :inherit.blank [true],\n   :debug nil,\n   :angle nil,\n   :size nil,\n   :face nil,\n   :lineheight nil,\n   :colour nil,\n   :vjust [0.0],\n   :margin [0.0 0.0 2.75 0.0]},\n  :strip.text.x.top nil,\n  :legend.spacing.y nil,\n  :text\n  {:hjust [0.5],\n   :family [\"\"],\n   :inherit.blank [true],\n   :debug [false],\n   :angle [0.0],\n   :size [11.0],\n   :face [\"plain\"],\n   :lineheight [0.9],\n   :colour [\"black\"],\n   :vjust [0.5],\n   :margin [0.0 0.0 0.0 0.0]}},\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"cty\"], :y [\"hwy\"], :colour [\"cyl\"]}}\n\n\n(delay\n  (-&gt; \"(ggplot(data.frame(x = rnorm(1000, 2, 2)), aes(x)) +\n      geom_histogram(aes(y=..density..)) +  # scale histogram y\n      geom_density(col = 'red', size=5))\"\n      r\n      plotting/plot-&gt;buffered-image))\n\n\n\n\n\n(delay\n  (-&gt; \"(ggplot(data.frame(x = rnorm(1000, 2, 2)), aes(x)) +\n      geom_histogram(aes(y=..density..)) +  # scale histogram y\n      geom_density(col = 'red'))\"\n      r\n      representing/ggplot-&gt;clj\n      (dissoc :data)))\n\n\n{:layers\n [{:aes_params [],\n   :stat\n   {:default_aes\n    {:x [~ [after_stat count]],\n     :y [~ [after_stat count]],\n     :weight [1.0]},\n    :extra_params [\"na.rm\" \"orientation\"],\n    :super :ggproto-method,\n    :compute_group :ggproto-method,\n    :required_aes [\"x|y\"],\n    :setup_params :ggproto-method,\n    :dropped_aes [\"weight\"]},\n   :show.legend [nil],\n   :mapping {:y [~ ..density..]},\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params {:na.rm [false], :orientation [nil]},\n   :geom\n   {:setup_data :ggproto-method,\n    :rename_size [true],\n    :non_missing_aes [\"xmin\" \"xmax\" \"ymin\" \"ymax\"],\n    :extra_params [\"just\" \"na.rm\" \"orientation\"],\n    :super :ggproto-method,\n    :required_aes [\"x\" \"y\"],\n    :draw_panel :ggproto-method,\n    :setup_params :ggproto-method},\n   :stat_params\n   {:binwidth nil,\n    :bins nil,\n    :na.rm [false],\n    :orientation [nil],\n    :pad [false]},\n   :constructor [geom_histogram {0 aes, :y ..density..}],\n   :position\n   {:setup_data :ggproto-method,\n    :type nil,\n    :compute_panel :ggproto-method,\n    :vjust [1.0],\n    :reverse [false],\n    :super :ggproto-method,\n    :fill [false],\n    :setup_params :ggproto-method},\n   :data []}\n  {:aes_params {:colour [\"red\"]},\n   :stat\n   {:default_aes\n    {:x [~ [after_stat density]],\n     :y [~ [after_stat density]],\n     :fill [nil],\n     :weight nil},\n    :extra_params [\"na.rm\" \"orientation\"],\n    :super :ggproto-method,\n    :compute_group :ggproto-method,\n    :required_aes [\"x|y\"],\n    :setup_params :ggproto-method,\n    :dropped_aes [\"weight\"]},\n   :show.legend [nil],\n   :mapping nil,\n   :super :ggproto-method,\n   :inherit.aes [true],\n   :geom_params\n   {:na.rm [false], :orientation [nil], :outline.type [\"upper\"]},\n   :geom\n   {:default_aes\n    {:fill [nil],\n     :weight [1.0],\n     :colour [\"black\"],\n     :alpha [nil],\n     :linewidth [0.5],\n     :linetype [1.0]},\n    :super :ggproto-method},\n   :stat_params {:na.rm [false], :orientation [nil]},\n   :constructor {: nil, :col [\"red\"]},\n   :position {:compute_layer :ggproto-method, :super :ggproto-method},\n   :data []}],\n :scales {:scales [], :super :ggproto-method},\n :mapping {:x [~ x]},\n :theme [],\n :coordinates\n {:expand [true],\n  :clip [\"on\"],\n  :limits {:x nil, :y nil},\n  :super :ggproto-method,\n  :default [true]},\n :facet {:shrink [true], :super :ggproto-method},\n :labels {:x [\"x\"], :y [\"density\"], :fill [\"fill\"], :weight [\"weight\"]}}\n\n\n10 Exploring ggtrace\nggtrace - programmatically explore, debug, and manipulate ggplot internals\n\n(r/require-r '[ggtrace :as ggtrace])\n\n\nnil\n\n\n(let [bar-plot (r \"\nggplot(mpg, aes(class, fill = class)) +\ngeom_bar() +\ntheme(legend.position = 'none')\")]\n  (ggtrace/layer_after_stat bar-plot))\n\n\n# A tibble: 7 × 8\n  count  prop x          width flipped_aes fill       PANEL group\n  &lt;dbl&gt; &lt;dbl&gt; &lt;mppd_dsc&gt; &lt;dbl&gt; &lt;lgl&gt;       &lt;chr&gt;      &lt;fct&gt; &lt;int&gt;\n1     5     1 1            0.9 FALSE       2seater    1         1\n2    47     1 2            0.9 FALSE       compact    1         2\n3    41     1 3            0.9 FALSE       midsize    1         3\n4    11     1 4            0.9 FALSE       minivan    1         4\n5    33     1 5            0.9 FALSE       pickup     1         5\n6    35     1 6            0.9 FALSE       subcompact 1         6\n7    62     1 7            0.9 FALSE       suv        1         7\n\n\n\nsource: projects/datavis/ggplot/notebooks/draft.clj",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Draft explorations</span>"
    ]
  }
]